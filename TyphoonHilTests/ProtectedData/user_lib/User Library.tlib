//
// Saved by sw version: 2021.3
// Save timestamp: 05-Jul-2021 @ 03:57:04 PM
//

library "User Component Library" {
    configuration {
        hil_device = "HIL402"
        hil_configuration_id = 1
        simulation_method = exact
        simulation_time_step = auto
        simulation_discret_scaling = 1.0
        dsp_timer_periods = 100e-6, 50e-3
        ss_calc_method = "systematic elimination"
        enb_pole_shift = True
        enb_gds_oversampling = True
        show_modes = False
        device_ao_limit_enable = False
        reset_analog_outputs_on_sim_stop = True
        reset_digital_outputs_on_sim_stop = True
        cpl_stb = False
        enb_dep_sw_detect = False
        code_section = "internal memory"
        data_section = "internal memory"
        sys_sp_rate_1 = 0.0001
        sys_sp_rate_2 = 0.05
        sys_real_type_precision = "default"
        user_real_type_precision = "default"
        sys_cpu_optimization = "high"
        user_cpu_optimization = "high"
        user_cpu_part_option = "default"
        matrix_based_reduction = True
        cpl_dynamics_analysis = False
        export_ss_to_pickle = False
        ground_scope_core = False
        cce_platform = "generic"
        cce_use_relative_names = False
        cce_type_mapping_real = "double"
        cce_type_mapping_uint = "unsigned int"
        cce_type_mapping_int = "int"
        cce_directory = ""
        cce_custom_type_int = ""
        cce_custom_type_uint = ""
        cce_custom_type_real = ""
        tunable_params = "component defined"
    }

    component Subsystem Root {
        component Subsystem "NPC PV Inverter" {
            layout = static
            component pas_resistor R4 {
                resistance = "10000"
            }
            [
                position = 7944, 8040
                rotation = right
            ]

            component pas_inductor L1 {
                inductance = "50e-6"
            }
            [
                position = 8624, 7992
            ]

            component gen_logic_op "Logical operator1" {
            }
            [
                position = 8856, 7480
                hide_name = True
            ]

            component gen_terminator Termination7 {
            }
            [
                position = 9264, 8760
                hide_name = True
            ]

            component pas_capacitor C6 {
                capacitance = "18.8e-2"
                initial_voltage = "500"
            }
            [
                position = 8032, 8040
                rotation = right
            ]

            component pas_inductor L4 {
                inductance = "50e-6"
            }
            [
                position = 9464, 7992
            ]

            component gen_terminator Termination9 {
            }
            [
                position = 9784, 9344
                hide_name = True
                scale = -1, 1
            ]

            component gen_bus_join "bus join" {
                inputs = "6"
            }
            [
                position = 9456, 8928
                rotation = right
                hide_name = True
            ]

            component gen_product Product1 {
            }
            [
                position = 6656, 7424
                rotation = right
                hide_name = True
                scale = -1, 1
            ]

            component gen_probe "Probe Vdcref" {
            }
            [
                position = 5832, 7432
                scale = -1, 1
            ]

            component gen_digital_probe precharge_contactor {
            }
            [
                position = 10048, 7744
            ]

            component pas_resistor R2 {
                resistance = "0.5"
            }
            [
                position = 9912, 8384
            ]

            component pas_inductor L2 {
                inductance = "50e-6"
            }
            [
                position = 8624, 8088
            ]

            component gen_sign Sign1 {
            }
            [
                position = 7800, 7704
                rotation = left
                hide_name = True
            ]

            component pas_capacitor C4 {
                capacitance = "600e-6"
            }
            [
                position = 9128, 8272
                rotation = right
            ]

            component pas_inductor L3 {
                inductance = "50e-6"
            }
            [
                position = 8624, 8184
            ]

            component gen_probe "model states" {
            }
            [
                position = 9512, 9136
            ]

            component gen_probe "real states" {
            }
            [
                position = 9512, 9008
            ]

            component gen_logic_op "Logical operator2" {
            }
            [
                position = 9176, 7552
                hide_name = True
            ]

            component gen_probe "Probe iref_al" {
            }
            [
                position = 6936, 7464
                rotation = left
            ]

            component pas_capacitor C5 {
                capacitance = "600e-6"
            }
            [
                position = 9192, 8272
                rotation = right
            ]

            component gen_bus_split "Bus Split1" {
                outputs = "6"
            }
            [
                position = 7056, 7336
                hide_name = True
            ]

            component gen_bus_join "Bus Join1" {
                inputs = "19"
            }
            [
                position = 6784, 6704
                rotation = left
                hide_name = True
            ]

            component gen_terminator Termination6 {
            }
            [
                position = 9264, 8640
                hide_name = True
            ]

            component gen_terminator Termination11 {
            }
            [
                position = 6736, 7440
                rotation = left
                hide_name = True
            ]

            component gen_digital_probe contactor {
            }
            [
                position = 10048, 7808
            ]

            component pas_inductor L6 {
                inductance = "50e-6"
            }
            [
                position = 9464, 8184
            ]

            component src_constant Constant1 {
                execution_rate = "inherit"
                value = "0"
            }
            [
                position = 7488, 7576
                hide_name = True
            ]

            component pas_resistor R1 {
                resistance = "0.5"
            }
            [
                position = 9912, 8288
            ]

            component sys_signal_switch "Signal switch1" {
                threshold = "0.5"
            }
            [
                position = 9592, 9072
                hide_name = True
            ]

            component gen_probe "Probe Qref" {
            }
            [
                position = 6392, 7472
                rotation = left
            ]

            component pas_resistor R3 {
                resistance = "0.5"
            }
            [
                position = 9912, 8480
            ]

            component pas_capacitor C3 {
                capacitance = "600e-6"
            }
            [
                position = 9064, 8272
                rotation = right
            ]

            component gen_terminator Termination10 {
            }
            [
                position = 8776, 7528
                hide_name = True
            ]

            component gen_sign Sign3 {
            }
            [
                position = 7864, 7784
                rotation = left
                hide_name = True
            ]

            component gen_terminator Termination12 {
            }
            [
                position = 6784, 7440
                rotation = left
                hide_name = True
            ]

            component pas_resistor R5 {
                resistance = "10000"
            }
            [
                position = 7944, 8136
                rotation = right
            ]

            component pas_inductor L5 {
                inductance = "50e-6"
            }
            [
                position = 9464, 8088
            ]

            component gen_probe "Probe Pref" {
            }
            [
                position = 6280, 7464
                rotation = left
            ]

            component pas_capacitor C7 {
                capacitance = "18.8e-2"
                initial_voltage = "500"
            }
            [
                position = 8032, 8136
                rotation = right
            ]

            component gen_terminator Termination8 {
            }
            [
                position = 9264, 8888
                hide_name = True
            ]

            component gen_sign Sign2 {
            }
            [
                position = 7832, 7744
                rotation = left
                hide_name = True
            ]

            component gen_probe "Probe iref_be" {
            }
            [
                position = 6936, 7560
                rotation = left
            ]

            component "core/Voltage Measurement" vg_a {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 10256, 8264
                rotation = right
                size = 64, 32
            ]

            component "core/Generic UL 1741 ride-through" "Frequency ride-through" {
                H1cessation = "False"
                H1duration = "299"
                H1val = "1.0083333"
                H2cessation = "False"
                H2val = "1.03333"
                L1cessation = "False"
                L1duration = "299"
                L1val = "0.975"
                L2cessation = "False"
                L2val = "0.95"
                L3cessation = "False"
                Nom = "fnom"
            }
            [
                position = 8664, 7552
                size = 120, 88
            ]

            component "core/Constant power factor" "Constant power factor" {
            }
            [
                position = 6296, 7584
                size = 64, 96
            ]

            component "core/Open-loop Power Controller" "Open-loop Power Controller" {
                imax = "1200"
                ratemax = "1000*10000"
            }
            [
                position = 6720, 7560
                size = 176, 144
            ]

            component "core/Voltage Measurement" V_dc {
                execution_rate = "200e-6"
                sig_output = "True"
            }
            [
                position = 7776, 8088
                rotation = right
                size = 64, 32
            ]

            component "core/Voltage Measurement" vc_c {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 8952, 8232
                rotation = right
                size = 64, 32
            ]

            component "core/Current Measurement" Ic_a {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 8512, 7992
                size = 64, 32
            ]

            component "core/Current Measurement" Ig_b {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 9592, 8088
                size = 64, 32
            ]

            component "core/abc to alfa-beta-gamma" "abc to alfa-beta-gamma3" {
            }
            [
                position = 9184, 8864
                hide_name = True
                size = 48, 88
            ]

            component "core/Voltage Measurement" vc_b {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 8896, 8136
                rotation = right
                size = 64, 32
            ]

            component "core/abc to alfa-beta-gamma" "abc to alfa-beta-gamma2" {
            }
            [
                position = 9184, 8736
                hide_name = True
                size = 48, 88
            ]

            component Subsystem "Fundamental positive sequence estimator" {
                layout = dynamic
                component gen_terminator Termination11 {
                }
                [
                    position = 8208, 8744
                    rotation = right
                    hide_name = True
                    scale = -1, 1
                ]

                component gen_terminator Termination12 {
                }
                [
                    position = 8176, 8784
                    rotation = right
                    hide_name = True
                    scale = -1, 1
                ]

                component gen_probe m_qva {
                }
                [
                    position = 7792, 8024
                    rotation = left
                ]

                component gen_probe "vpb rms" {
                }
                [
                    position = 8216, 8568
                ]

                component gen_probe m_va {
                }
                [
                    position = 7704, 8024
                    rotation = left
                ]

                component gen_c_function "Quad Signal Generator2" {
                    global_variables = "real estados_X1;real estados_X2;real estados_v_l;real estados_qv_l;real kq;real X01;real X02;real Ts;"
                    init_fnc = "/*Begin code section*/
estados_X1=0;
estados_X2=0;
estados_v_l=0;
estados_qv_l=0;
v = 0;
qv = 0;
kq=0.01; //// 0<kp<0.6 para w=377 e Ts = 1/10000
Ts = execution_rate;
/*End code section*/"
                    input_terminals = "real estados_v;inherit estados_w_h;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
X01 = estados_X2;
X02 = (-1./(kq-1.)-2.)*estados_X1 + ((cos(estados_w_h*Ts)*(3.*kq-2.))/(kq-1.))*estados_X2 + (-1./(kq-1.)-1.)*estados_v;

v = (-1./(kq-1.)-2.)*estados_X1 + ((cos(estados_w_h*Ts)*(2.*kq-1.))/(kq-1.))*estados_X2 + (kq/(1.-kq))*estados_v;
qv = sin(estados_w_h*Ts)*estados_X2;

estados_X1 = X01;
estados_X2 = X02;
/*End code section*/"
                    output_terminals = "real v;inherit qv;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;"
                }
                [
                    position = 7648, 8176
                    size = 48, 48
                ]

                component gen_c_function "filtered RMS calculation" {
                    init_fnc = "/*Begin code section*/
norm_v_p_a_f = 0;
norm_v_p_b_f = 0;
norm_v_p_c_f = 0;
norm_v_p_a = 0;
norm_v_p_b = 0;
norm_v_p_c = 0;
/*End code section*/"
                    input_terminals = "real va;inherit qva;inherit vb;inherit qvb;inherit vc;inherit qvc;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;False;False;False;False;"
                    output_fnc = "/*Begin code section*/
norm_v_p_a = sqrt(va*va + qva*qva);
norm_v_p_b = sqrt(vb*vb + qvb*qvb);
norm_v_p_c = sqrt(vc*vc + qvc*qvc);

norm_v_p_a_f = 0.99*norm_v_p_a_f + 0.01*norm_v_p_a*0.707;
norm_v_p_b_f = 0.99*norm_v_p_b_f + 0.01*norm_v_p_b*0.707;
norm_v_p_c_f = 0.99*norm_v_p_c_f + 0.01*norm_v_p_c*0.707;
/*End code section*/"
                    output_terminals = "real norm_v_p_a_f;inherit norm_v_p_b_f;inherit norm_v_p_c_f;inherit norm_v_p_a;inherit norm_v_p_b;inherit norm_v_p_c;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;False;False;False;"
                }
                [
                    position = 8072, 8624
                    size = 48, 112
                ]

                component gen_gain Gain5 {
                    gain = "0.5"
                }
                [
                    position = 8424, 8240
                    hide_name = True
                ]

                component gen_gain "to rads" {
                    gain = "2*np.pi"
                }
                [
                    position = 7568, 7992
                    rotation = right
                ]

                component gen_terminator Termination8 {
                }
                [
                    position = 8272, 8320
                    rotation = right
                    hide_name = True
                ]

                component gen_terminator Termination10 {
                }
                [
                    position = 8240, 8704
                    rotation = right
                    hide_name = True
                    scale = -1, 1
                ]

                component gen_gain Gain2 {
                    gain = "0.5"
                }
                [
                    position = 8376, 8000
                    hide_name = True
                ]

                component gen_c_function "Quad Signal Generator3" {
                    global_variables = "real estados_X1;real estados_X2;real estados_v_l;real estados_qv_l;real kq;real X01;real X02;real Ts;"
                    init_fnc = "/*Begin code section*/
estados_X1=0;
estados_X2=0;
estados_v_l=0;
estados_qv_l=0;
v = 0;
qv = 0;
kq=0.01; //// 0<kp<0.6 para w=377 e Ts = 1/10000
Ts = execution_rate;
/*End code section*/"
                    input_terminals = "real estados_v;inherit estados_w_h;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
X01 = estados_X2;
X02 = (-1./(kq-1.)-2.)*estados_X1 + ((cos(estados_w_h*Ts)*(3.*kq-2.))/(kq-1.))*estados_X2 + (-1./(kq-1.)-1.)*estados_v;

v = (-1./(kq-1.)-2.)*estados_X1 + ((cos(estados_w_h*Ts)*(2.*kq-1.))/(kq-1.))*estados_X2 + (kq/(1.-kq))*estados_v;
qv = sin(estados_w_h*Ts)*estados_X2;

estados_X1 = X01;
estados_X2 = X02;
/*End code section*/"
                    output_terminals = "real v;inherit qv;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;"
                }
                [
                    position = 7648, 8264
                    size = 48, 48
                ]

                component gen_c_function "Quad Signal Generator1" {
                    global_variables = "real estados_X1;real estados_X2;real estados_v_l;real estados_qv_l;real kq;real X01;real X02;real Ts;"
                    init_fnc = "/*Begin code section*/
estados_X1=0;
estados_X2=0;
estados_v_l=0;
estados_qv_l=0;
v = 0;
qv = 0;
kq=0.01; //// 0<kp<0.6 para w=377 e Ts = 1/10000
Ts = execution_rate;
/*End code section*/"
                    input_terminals = "real estados_v;inherit estados_w_h;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
X01 = estados_X2;
X02 = (-1./(kq-1.)-2.)*estados_X1 + ((cos(estados_w_h*Ts)*(3.*kq-2.))/(kq-1.))*estados_X2 + (-1./(kq-1.)-1.)*estados_v;

v = (-1./(kq-1.)-2.)*estados_X1 + ((cos(estados_w_h*Ts)*(2.*kq-1.))/(kq-1.))*estados_X2 + (kq/(1.-kq))*estados_v;
qv = sin(estados_w_h*Ts)*estados_X2;

estados_X1 = X01;
estados_X2 = X02;
/*End code section*/"
                    output_terminals = "real v;inherit qv;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;"
                }
                [
                    position = 7648, 8080
                    size = 48, 48
                ]

                component gen_gain Gain4 {
                    gain = "0.5"
                }
                [
                    position = 8424, 8184
                    hide_name = True
                ]

                component gen_sum Sum1 {
                    signs = "+-"
                }
                [
                    position = 8496, 8008
                    hide_name = True
                ]

                component gen_terminator Termination9 {
                }
                [
                    position = 8256, 8080
                    rotation = right
                    hide_name = True
                ]

                component gen_gain Gain3 {
                    gain = "0.5"
                }
                [
                    position = 8376, 8064
                    hide_name = True
                ]

                component gen_sum Sum2 {
                }
                [
                    position = 8496, 8232
                    hide_name = True
                ]

                component gen_probe "vpa rms" {
                }
                [
                    position = 8184, 8456
                ]

                component gen_probe "vpc rms" {
                }
                [
                    position = 8288, 8576
                    rotation = left
                ]

                component "core/abc to alfa-beta-gamma" "abc to alfa-beta-gamma2" {
                }
                [
                    position = 8168, 8256
                    hide_name = True
                    size = 48, 64
                ]

                component "core/abc to alfa-beta-gamma" "abc to alfa-beta-gamma1" {
                }
                [
                    position = 8152, 8016
                    hide_name = True
                    size = 48, 64
                ]

                port va {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7496, 8072
                ]

                port vb {
                    position = left:3
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7496, 8168
                ]

                port vc {
                    position = left:4
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7496, 8256
                ]

                port vp_al {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8576, 8008
                ]

                port vp_be {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8576, 8232
                ]

                port vpa_rms {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8128, 8408
                    rotation = left
                ]

                port vpb_rms {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8160, 8520
                    rotation = left
                ]

                port vpc_rms {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8336, 8616
                ]

                port f {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7568, 7912
                    rotation = right
                ]

                junction Junction157 sp
                [
                    position = 7568, 8088
                ]

                junction Junction158 sp
                [
                    position = 7568, 8184
                ]

                junction Junction166 sp
                [
                    position = 8128, 8456
                ]

                junction Junction168 sp
                [
                    position = 8288, 8616
                ]

                junction Junction169 sp
                [
                    position = 7704, 8072
                ]

                junction Junction171 sp
                [
                    position = 8008, 8072
                ]

                junction Junction172 sp
                [
                    position = 7944, 8168
                ]

                junction Junction173 sp
                [
                    position = 7880, 8256
                ]

                junction Junction176 sp
                [
                    position = 7864, 8272
                ]

                junction Junction177 sp
                [
                    position = 8160, 8568
                ]

                junction Junction178 sp
                [
                    position = 7928, 8256
                ]

                junction Junction179 sp
                [
                    position = 7792, 8088
                ]

                junction Junction180 sp
                [
                    position = 7992, 8240
                ]

                connect Gain2.in "abc to alfa-beta-gamma1.al" as Connection1081
                connect Gain3.out Sum1.in1 as Connection1025
                connect Gain4.in "abc to alfa-beta-gamma1.be" as Connection1082
                [
                    position = 0, 0
                ]
                connect Gain5.out Sum2.in1 as Connection1027
                connect Gain5.in "abc to alfa-beta-gamma2.al" as Connection1097
                connect Junction157 "Quad Signal Generator1.estados_w_h" as Connection1017
                connect Junction157 "to rads.out" as Connection1112
                connect Junction158 Junction157 as Connection1020
                connect Junction166 "filtered RMS calculation.norm_v_p_a_f" as Connection1064
                connect Junction168 "filtered RMS calculation.norm_v_p_c_f" as Connection1070
                connect Junction169 Junction171 as Connection1085
                connect Junction171 "filtered RMS calculation.va" as Connection1086
                connect Junction172 "filtered RMS calculation.vb" as Connection1090
                connect Junction173 "filtered RMS calculation.vc" as Connection1094
                connect Junction176 "filtered RMS calculation.qvc" as Connection1110
                connect Junction177 vpb_rms as Connection1116
                connect Junction178 "filtered RMS calculation.qvb" as Connection1120
                connect Junction179 Junction180 as Connection1128
                connect Junction179 m_qva.in as Connection1125
                [
                    position = 0, 0
                ]
                connect Junction180 "filtered RMS calculation.qva" as Connection1127
                [
                    position = 0, 0
                    breakpoints = 7992, 8240
                ]
                connect "Quad Signal Generator1.v" Junction169 as Connection1075
                connect "Quad Signal Generator1.qv" Junction179 as Connection1124
                connect "Quad Signal Generator1.estados_v" va as Connection1034
                connect "Quad Signal Generator2.estados_w_h" Junction158 as Connection1019
                connect "Quad Signal Generator2.v" Junction172 as Connection1089
                connect "Quad Signal Generator2.qv" Junction178 as Connection1121
                connect "Quad Signal Generator2.estados_v" vb as Connection1032
                connect "Quad Signal Generator3.estados_w_h" Junction158 as Connection1021
                connect "Quad Signal Generator3.v" Junction173 as Connection1093
                connect "Quad Signal Generator3.qv" Junction176 as Connection1109
                connect "Quad Signal Generator3.estados_v" vc as Connection1033
                connect Sum1.in Gain2.out as Connection1024
                connect Sum1.out vp_al as Connection1036
                connect Sum2.in Gain4.out as Connection1026
                connect Sum2.out vp_be as Connection1037
                connect Termination10.in "filtered RMS calculation.norm_v_p_a" as Connection1072
                connect Termination11.in "filtered RMS calculation.norm_v_p_b" as Connection1073
                connect Termination12.in "filtered RMS calculation.norm_v_p_c" as Connection1074
                connect Termination8.in "abc to alfa-beta-gamma2.y" as Connection1099
                connect Termination9.in "abc to alfa-beta-gamma1.y" as Connection1083
                connect "abc to alfa-beta-gamma1.a" Junction171 as Connection1087
                connect "abc to alfa-beta-gamma1.b" Junction172 as Connection1091
                connect "abc to alfa-beta-gamma1.c" Junction173 as Connection1095
                connect "abc to alfa-beta-gamma2.be" Gain3.in as Connection1098
                connect "abc to alfa-beta-gamma2.c" Junction176 as Connection1111
                connect "abc to alfa-beta-gamma2.b" Junction178 as Connection1119
                connect "abc to alfa-beta-gamma2.a" Junction180 as Connection1126
                connect "filtered RMS calculation.norm_v_p_b_f" Junction177 as Connection1117
                connect m_va.in Junction169 as Connection1077
                connect "to rads.in" f as Connection1113
                connect "vpa rms.in" Junction166 as Connection1065
                connect vpa_rms Junction166 as Connection1063
                connect "vpb rms.in" Junction177 as Connection1115
                connect "vpc rms.in" Junction168 as Connection1071
                connect vpc_rms Junction168 as Connection1069

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Calculates alfa-beta transformation and RMS values of the positive-sequence component of the fundamental voltage.</span></p></body></html>"

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 8552, 8600
                size = 200, 152
            ]

            component "core/Voltage Measurement" vg_c {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 10352, 8360
                rotation = right
                size = 64, 32
            ]

            component Subsystem "Grid connection sequencing" {
                layout = dynamic
                component gen_c_function "Startup routine" {
                    global_variables = "real contactor_count;real Fs;"
                    init_fnc = "/*Begin code section*/
Fs = 1/execution_rate;
contactor_count = 0;
/*End code section*/"
                    input_terminals = "real rt_enable;"
                    input_terminals_dimensions = "inherit"
                    input_terminals_feedthrough = "[\'\']"
                    output_fnc = "/*Begin code section*/
if (rt_enable) {
    if (contactor_count == 0.) contactor1 = 1;

    if (contactor_count > (T1*Fs)){
        contactor2 = 1;
        contactor1 = 0;
    }
    contactor_count++;

    if (contactor_count > (T2*Fs))
    {
       inv_enable = 1;
        contactor_count = (T2*Fs+1.);
    }
} else {
    contactor_count = 0;
    contactor1 = 0;
    contactor2 = 0;
    inv_enable = 0;
}
/*End code section*/"
                    output_terminals = "real contactor1;inherit contactor2;inherit inv_enable;"
                    output_terminals_dimensions = "inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;"
                    parameters = "real T1;real T2;"
                }
                [
                    position = 8192, 8192
                    size = 0, 0
                ]

                component gen_probe enable_inv_gridcon {
                }
                [
                    position = 8384, 8264
                ]

                port "Pre-charge contactor" {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8288, 8096
                    rotation = left
                ]

                port "Main contactor" {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8376, 8192
                ]

                port "Inverter enable" {
                    position = right:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8288, 8304
                    rotation = right
                ]

                port "RT Enable" {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8072, 8192
                ]

                junction Junction1 sp
                [
                    position = 8288, 8264
                ]

                connect Junction1 "Inverter enable" as Connection7
                connect "Startup routine.inv_enable" Junction1 as Connection6
                connect "Startup routine.contactor2" "Main contactor" as Connection1
                connect "Startup routine.contactor1" "Pre-charge contactor" as Connection2
                connect "Startup routine.rt_enable" "RT Enable" as Connection4
                connect enable_inv_gridcon.in Junction1 as Connection8

                T2 = "1"

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Coordinates the closing of converter contactors and converter switching enable when connecting to the grid if voltages are proper. Otherwise disconnects the converter.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">At t = 0 (when grid voltages become proper), closes precharging contactor. At t = t1, prechargin contactor is bypassed. At t = t2 inverter enable output is enabled.</span></p></body></html>"

                    T1 {
                        label = "Charging time"
                        widget = edit
                        type = generic
                        default_value = "0.25"
                        unit = "seconds"
                    }

                    T2 {
                        label = "Enable inverter time"
                        widget = edit
                        type = generic
                        default_value = "5"
                        unit = "seconds"
                    }

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 8992, 7480
                size = 152, 88
            ]

            component "core/Triple Pole Single Throw Contactor" S2 {
                Sa = "19"
                ctrl_src = "Model"
            }
            [
                position = 10008, 8384
                size = 64, 256
            ]

            component Subsystem "State feedback Resonant Current Controller" {
                layout = dynamic
                component gen_probe error_al {
                }
                [
                    position = 8096, 7936
                    rotation = left
                ]

                component gen_c_function "current controller" {
                    execution_rate = "200e-6"
                    global_variables = "real erro_i_al;real erro_i_be;real xc11_al;real xc11_be;real xc11m_al;real xc11m_be;real xc12_al;real xc12_be;real xc12m_al;real xc12m_be;real u_al_prev;real u_be_prev;real xc51_al;real xc52_al;real xc51m_al;real xc52m_al;real xc51_be;real xc52_be;real xc51m_be;real xc52m_be;real xc71_al;real xc72_al;real xc71m_al;real xc72m_al;real xc71_be;real xc72_be;real xc71m_be;real xc72m_be;real xc111_al;real xc112_al;real xc111m_al;real xc112m_al;real xc111_be;real xc112_be;real xc111m_be;real xc112m_be;real pi;real w;real zeta;real a1;real a5;real a7;real a11;real kres11;real kres12;real kres51;real kres52;real kres71;real kres72;real kres111;real kres112;real tmp;real Ts;"
                    init_fnc = "/*Begin code section*/
wek = 376.9911;
pi = 3.141592653589793238;
Ts = execution_rate;
// Resonant Controller definition

w = 2*pi*fnom;
zeta = 0.0001;

tmp = 1 - powf(zeta , 2);

a1  = w*zeta/(sqrt(tmp));
a5  = 5*w*zeta/(sqrt(tmp));
a7  = 7*w*zeta/(sqrt(tmp));
a11 = 11*w*zeta/(sqrt(tmp));

kres11=-exp(-2*a1*Ts);
kres12=exp(-a1*Ts);

kres51=-exp(-2*a5*Ts);
kres52=exp(-a5*Ts);

kres71=-exp(-2*a7*Ts);
kres72=exp(-a7*Ts);

kres111=-exp(-2*a11*Ts);
kres112=exp(-a11*Ts);

// State initialization

xc11_al = 0.;
xc12_al = 0.;
xc51_al = 0.;
xc52_al = 0.;
xc71_al = 0.;
xc72_al = 0.;
xc111_al = 0.;
xc112_al = 0.;
xc11m_al = 0.;
xc12m_al = 0.;
xc51m_al = 0.;
xc52m_al = 0.;
xc71m_al = 0.;
xc72m_al = 0.;
xc111m_al = 0.;
xc112m_al = 0.;
xc11_be = 0.;
xc12_be = 0.;
xc51_be = 0.;
xc52_be = 0.;
xc71_be = 0.;
xc72_be = 0.;
xc111_be = 0.;
xc112_be = 0.;
xc11m_be = 0.;
xc12m_be = 0.;
xc51m_be = 0.;
xc52m_be = 0.;
xc71m_be = 0.;
xc72m_be = 0.;
xc111m_be = 0.;
xc112m_be = 0.;

u_al_prev = 0;
u_be_prev = 0;
/*End code section*/"
                    input_terminals = "inherit ig_al;inherit ig_be;inherit ic_al;inherit ic_be;inherit vc_al;inherit vc_be;inherit wek;inherit iref_al;inherit iref_be;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;False;False;False;False;False;False;False;"
                    output_fnc = "/*Begin code section*/
// UPDATE OF STATE CONTROLLER STATES
xc11_al = xc11m_al;
xc12_al = xc12m_al;
xc51_al = xc51m_al;
xc52_al = xc52m_al;
xc71_al = xc71m_al;
xc72_al = xc72m_al;
xc111_al = xc111m_al;
xc112_al = xc112m_al;

xc11_be = xc11m_be;
xc12_be = xc12m_be;
xc51_be = xc51m_be;
xc52_be = xc52m_be;
xc71_be = xc71m_be;
xc72_be = xc72m_be;
xc111_be = xc111m_be;
xc112_be = xc112m_be;

erro_i_al = iref_al - ig_al;
erro_i_be = iref_be - ig_be;

u_al = -(k0*ic_al + k1*vc_al + k2*ig_al+ k3*u_al + k4*xc11_al + k5*xc12_al + k6*xc51_al + k7*xc52_al + k8*xc71_al + k9*xc72_al + k10*xc111_al + k11*xc112_al);
u_be = -(k0*ic_be + k1*vc_be + k2*ig_be+ k3*u_be + k4*xc11_be + k5*xc12_be + k6*xc51_be + k7*xc52_be + k8*xc71_be + k9*xc72_be + k10*xc111_be + k11*xc112_be);

u_al_prev = u_al;
u_be_prev = u_be;

//if (1)//(absolut(eal)<1.)
//{
    xc11m_al = xc12_al;
    xc12m_al = kres11*xc11_al + 2.*kres12*cos(wek*Ts)*xc12_al + erro_i_al;
    xc51m_al = xc52_al;
    xc52m_al = kres51*xc51_al + 2.*kres52*cos(5.*wek*Ts)*xc52_al + erro_i_al;
    xc71m_al = xc72_al;
    xc72m_al = kres71*xc71_al + 2.*kres72*cos(7.*wek*Ts)*xc72_al + erro_i_al;
    xc111m_al = xc112_al;
    xc112m_al = kres111*xc111_al + 2.*kres112*cos(11.*wek*Ts)*xc112_al + erro_i_al;
//}

//if (1)//(absolut(ebe)<1.)
//{
    xc11m_be = xc12_be;
    xc12m_be = kres11*xc11_be + 2.*kres12*cos(wek*Ts)*xc12_be + erro_i_be;
    xc51m_be = xc52_be;
    xc52m_be = kres51*xc51_be + 2.*kres52*cos(5.*wek*Ts)*xc52_be + erro_i_be;
    xc71m_be = xc72_be;
    xc72m_be = kres71*xc71_be + 2.*kres72*cos(7.*wek*Ts)*xc72_be + erro_i_be;
    xc111m_be = xc112_be;
    xc112m_be = kres111*xc111_be + 2.*kres112*cos(11.*wek*Ts)*xc112_be + erro_i_be;
//}

debug1 = erro_i_al;
debug2 = erro_i_be;
debug3 = xc52m_al;
debug4 = xc52m_be;
debug5 = xc72m_al;
debug6 = xc72m_be;
/*End code section*/"
                    output_terminals = "inherit u_al;inherit u_be;inherit debug1;inherit debug2;inherit debug3;inherit debug4;inherit debug5;inherit debug6;inherit debug7;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;False;False;False;False;False;False;"
                    parameters = "real fnom;real k0;real k1;real k2;real k3;real k4;real k5;real k6;real k7;real k8;real k9;real k10;real k11;"
                }
                [
                    position = 7848, 8016
                    size = 0, 0
                ]

                component gen_probe xc12m_be {
                }
                [
                    position = 8000, 8168
                    rotation = right
                ]

                component gen_gain "to rads" {
                    gain = "2*np.pi"
                }
                [
                    position = 7552, 7976
                    rotation = right
                ]

                component gen_probe xc11m_be {
                }
                [
                    position = 8064, 8232
                    rotation = right
                ]

                component gen_probe m_u_al {
                }
                [
                    position = 8064, 7832
                ]

                component gen_probe unused {
                }
                [
                    position = 7968, 8136
                    rotation = right
                ]

                component gen_probe xc11m_al {
                }
                [
                    position = 8096, 8264
                    rotation = right
                ]

                component gen_probe xc12m_al {
                }
                [
                    position = 8032, 8200
                    rotation = right
                ]

                component gen_probe m_u_be {
                }
                [
                    position = 8016, 7856
                ]

                component gen_probe error_be {
                }
                [
                    position = 8152, 8000
                ]

                port u_al {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 7920, 7752
                    rotation = left
                ]

                port u_be {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 7960, 7784
                    rotation = left
                ]

                port ig_al {
                    position = top:20
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7720, 7656
                    rotation = right
                ]

                port ig_be {
                    position = top:30
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7696, 7696
                    rotation = right
                ]

                port ic_al {
                    position = top:40
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7672, 7736
                    rotation = right
                ]

                port ic_be {
                    position = top:50
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7648, 7768
                    rotation = right
                ]

                port vc_al {
                    position = top:60
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7616, 7800
                    rotation = right
                ]

                port vc_be {
                    position = top:70
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7592, 7840
                    rotation = right
                ]

                port ig_be_ref {
                    position = left:100
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7440, 7952
                    rotation = right
                ]

                port ig_al_ref {
                    position = left:99
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7472, 7920
                    rotation = right
                ]

                port f {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7552, 7880
                    rotation = right
                ]

                junction Junction1 sp
                [
                    position = 7920, 7832
                ]

                junction Junction2 sp
                [
                    position = 7960, 7856
                ]

                connect Junction1 "current controller.u_al" as Connection1405
                connect Junction1 u_al as Connection1434
                connect Junction2 "current controller.u_be" as Connection1408
                connect Junction2 u_be as Connection1435
                connect "current controller.iref_al" ig_al_ref as Connection1368
                connect "current controller.iref_be" ig_be_ref as Connection1364
                connect "current controller.wek" "to rads.out" as Connection1442
                connect error_al.in "current controller.debug1" as Connection1359
                connect error_be.in "current controller.debug2" as Connection1021
                connect ic_al "current controller.ic_al" as Connection1438
                connect ic_be "current controller.ic_be" as Connection1439
                connect ig_al "current controller.ig_al" as Connection1436
                connect ig_be "current controller.ig_be" as Connection1437
                connect m_u_al.in Junction1 as Connection1406
                connect m_u_be.in Junction2 as Connection1409
                connect "to rads.in" f as Connection1443
                connect unused.in "current controller.debug7" as Connection1026
                connect vc_al "current controller.vc_al" as Connection1440
                connect vc_be "current controller.vc_be" as Connection1441
                connect xc11m_al.in "current controller.debug3" as Connection1022
                connect xc11m_be.in "current controller.debug4" as Connection1023
                connect xc12m_al.in "current controller.debug5" as Connection1024
                connect xc12m_be.in "current controller.debug6" as Connection1025

                k0 = "0.0517436654205"
                k1 = "-0.175014904865"
                k10 = "-0.00103488062729"
                k11 = "0.00130712160229"
                k2 = "0.127386586845"
                k3 = "0.349012138783"
                k4 = "0.0129592962221"
                k5 = "-0.0131619258282"
                k6 = "0.000818190473868"
                k7 = "0.00019350199611"
                k8 = "-0.000229087380002"
                k9 = "0.00118601729715"

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Discrete LQR Resonant Current Controller</span></p></body></html>"

                    fnom {
                        label = "Fundamental Frequency"
                        widget = edit
                        type = generic
                        default_value = "fnom"
                        unit = "Hz"
                    }

                    k0 {
                        label = "k0"
                        widget = edit
                        type = generic
                        default_value = "gains[0]"
                    }

                    k1 {
                        label = "k1"
                        widget = edit
                        type = generic
                        default_value = "gains[1]"
                    }

                    k2 {
                        label = "k2"
                        widget = edit
                        type = generic
                        default_value = "gains[2]"
                    }

                    k3 {
                        label = "k3"
                        widget = edit
                        type = generic
                        default_value = "gains[3]"
                    }

                    k4 {
                        label = "k4"
                        widget = edit
                        type = generic
                        default_value = "gains[4]"
                    }

                    k5 {
                        label = "k5"
                        widget = edit
                        type = generic
                        default_value = "gains[5]"
                    }

                    k6 {
                        label = "k6"
                        widget = edit
                        type = generic
                        default_value = "gains[6]"
                    }

                    k7 {
                        label = "k7"
                        widget = edit
                        type = generic
                        default_value = "gains[7]"
                    }

                    k8 {
                        label = "k8"
                        widget = edit
                        type = generic
                        default_value = "gains[8]"
                    }

                    k9 {
                        label = "k9"
                        widget = edit
                        type = generic
                        default_value = "gains[9]"
                    }

                    k10 {
                        label = "k10"
                        widget = edit
                        type = generic
                        default_value = "gains[10]"
                    }

                    k11 {
                        label = "k11"
                        widget = edit
                        type = generic
                        default_value = "gains[11]"
                    }

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 7152, 7560
                size = 192, 136
            ]

            component "core/abc to alfa-beta-gamma" "abc to alfa-beta-gamma4" {
            }
            [
                position = 9864, 9320
                hide_name = True
                scale = -1, 1
                size = 48, 96
            ]

            component Subsystem PLL {
                layout = dynamic
                component gen_terminator Termination2 {
                }
                [
                    position = 8240, 8256
                    rotation = right
                    hide_name = True
                ]

                component gen_terminator Termination3 {
                }
                [
                    position = 8256, 8136
                    rotation = left
                    hide_name = True
                ]

                component "core/Three phase PLL" "Three phase PLL" {
                }
                [
                    position = 8144, 8200
                    hide_name = True
                    size = 0, 0
                ]

                component gen_terminator Termination1 {
                }
                [
                    position = 8208, 8304
                    rotation = right
                    hide_name = True
                ]

                component gen_terminator Termination4 {
                }
                [
                    position = 8232, 8096
                    rotation = left
                    hide_name = True
                ]

                component gen_terminator Termination5 {
                }
                [
                    position = 8208, 8056
                    rotation = left
                    hide_name = True
                ]

                port f {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8344, 8208
                ]

                port Va {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8064, 8104
                    rotation = right
                ]

                port Vb {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8008, 8200
                ]

                port Vc {
                    position = left:3
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8064, 8296
                    rotation = left
                ]

                connect Termination1.in "Three phase PLL.sin_theta" as Connection2061
                connect Termination2.in "Three phase PLL.theta" as Connection2062
                connect Termination3.in "Three phase PLL.zero_axis" as Connection2063
                connect Termination4.in "Three phase PLL.q_axis" as Connection2064
                connect Termination5.in "Three phase PLL.d_axis" as Connection2065
                connect "Three phase PLL.va" Va as Connection2066
                connect "Three phase PLL.vb" Vb as Connection2069
                connect "Three phase PLL.vc" Vc as Connection2068
                connect "Three phase PLL.freq" f as Connection2067
            }
            [
                position = 8552, 8440
                size = 48, 88
            ]

            component "core/Resistive Neutral" "Resistive Neutral1" {
                R = "1e4"
            }
            [
                position = 10624, 8320
                size = 112, 64
            ]

            component "core/Triple Pole Single Throw Contactor" S1 {
                Sa = "20"
                ctrl_src = "Model"
            }
            [
                position = 9944, 8088
                size = 64, 256
            ]

            component Subsystem MPPT {
                layout = dynamic
                component gen_probe "Probe ppv_ant" {
                }
                [
                    position = 8304, 8232
                    rotation = right
                ]

                component gen_probe "Probe ppv" {
                }
                [
                    position = 8040, 8064
                    rotation = left
                ]

                component gen_c_function "C function1" {
                    global_variables = "real vdc_ant;real ppv_ant;real vdc_ant_2;"
                    init_fnc = "/*Begin code section*/
vdc_ant_2 = vdc_init;
vdc_ant =vdc_init;
vdc = vdc_init;
ppv_ant = 0;
/*End code section*/"
                    input_terminals = "real ppv;real enable;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
debug1 = ppv_ant;
debug2 = vdc_ant;

if (enable) {
    if (ppv>ppv_ant) {
        if (vdc_ant>vdc_ant_2) {
            vdc += step;
        } else {
            vdc -= step;
        }
    } else {
        if (vdc_ant>vdc_ant_2) {
            vdc -= step;
        } else {
            vdc += step;
        }
    }
    vdc_ant_2 = vdc_ant;
    vdc_ant = vdc;
    ppv_ant = ppv;
} else {
    vdc_ant_2 = vdc_init;
    vdc_ant =vdc_init;
    vdc = vdc_init;
    ppv_ant = 0;
}
/*End code section*/"
                    output_terminals = "real vdc;inherit debug1;inherit debug2;"
                    output_terminals_dimensions = "inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;"
                    parameters = "real step;real vdc_init;"
                }
                [
                    position = 8128, 8128
                    hide_name = True
                    size = 48, 64
                ]

                component gen_probe "Probe vdc_ant" {
                }
                [
                    position = 8264, 8192
                    rotation = right
                ]

                component "core/Rate Transition" "Rate Transition3" {
                    execution_rate = "Ts"
                }
                [
                    position = 7968, 8192
                    hide_name = True
                    size = 32, 32
                ]

                component "core/Rate Transition" "Rate Transition2" {
                    execution_rate = "inherit"
                }
                [
                    position = 8344, 8112
                    hide_name = True
                    size = 32, 32
                ]

                component "core/Rate Transition" "Rate Transition1" {
                    execution_rate = "Ts"
                }
                [
                    position = 7968, 8112
                    hide_name = True
                    size = 32, 32
                ]

                port "PV Power" {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7816, 8112
                ]

                port Vdc {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8472, 8112
                ]

                port Enable {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7816, 8192
                ]

                junction Junction1 sp
                [
                    position = 8040, 8112
                ]

                connect "C function1.ppv" Junction1 as Connection9
                connect "C function1.vdc" "Rate Transition2.in" as Connection5
                connect Junction1 "Rate Transition1.out" as Connection10
                connect "Probe ppv.in" Junction1 as Connection11
                connect "Probe ppv_ant.in" "C function1.debug1" as Connection12
                connect "Probe vdc_ant.in" "C function1.debug2" as Connection13
                connect "Rate Transition1.in" "PV Power" as Connection4
                connect "Rate Transition2.out" Vdc as Connection6
                connect "Rate Transition3.out" "C function1.enable" as Connection8
                connect "Rate Transition3.in" Enable as Connection7

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Fixed step MPPT algorithm.</p></body></html>"

                    step {
                        label = "Voltage step"
                        widget = edit
                        type = generic
                        default_value = "5"
                        unit = "dc volts"
                    }

                    vdc_init {
                        label = "Initial voltage"
                        widget = edit
                        type = generic
                        default_value = "1000"
                        unit = "dc volts"
                    }

                    Ts {
                        label = "Execution rate"
                        widget = edit
                        type = generic
                        default_value = "0.5"
                        unit = "seconds"
                    }

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 5960, 7400
                scale = -1, 1
                size = 88, 48
            ]

            component Subsystem "PCC Measurements" {
                layout = dynamic
                component gen_rms_value RMS6 {
                    frequency = "60"
                    op_mode = "Fixed frequency"
                }
                [
                    position = 8224, 8352
                    hide_name = True
                    scale = 1, -1
                ]

                component gen_rms_value RMS3 {
                    frequency = "60"
                    op_mode = "Fixed frequency"
                }
                [
                    position = 8224, 8016
                    hide_name = True
                    scale = 1, -1
                ]

                component gen_rms_value RMS7 {
                    frequency = "60"
                    op_mode = "Fixed frequency"
                }
                [
                    position = 8224, 8408
                    hide_name = True
                    scale = 1, -1
                ]

                component gen_rms_value RMS5 {
                    frequency = "60"
                    op_mode = "Fixed frequency"
                }
                [
                    position = 8224, 7960
                    hide_name = True
                    scale = 1, -1
                ]

                component gen_rms_value RMS4 {
                    frequency = "60"
                    op_mode = "Fixed frequency"
                }
                [
                    position = 8224, 7904
                    hide_name = True
                    scale = 1, -1
                ]

                component gen_rms_value RMS8 {
                    frequency = "60"
                    op_mode = "Fixed frequency"
                }
                [
                    position = 8224, 8464
                    hide_name = True
                    scale = 1, -1
                ]

                component Subsystem "Power Measurements" {
                    layout = dynamic
                    component gen_terminator Term2 {
                    }
                    [
                        position = 8416, 8160
                        rotation = left
                        hide_name = True
                    ]

                    component gen_terminator Term3 {
                    }
                    [
                        position = 8384, 8120
                        rotation = left
                        hide_name = True
                    ]

                    component gen_PQ_transform "Power Meter1" {
                    }
                    [
                        position = 8192, 8192
                        hide_name = True
                    ]

                    port P {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8256, 8096
                        rotation = left
                    ]

                    port Q {
                        position = right:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8096
                        rotation = left
                    ]

                    port Vg_a {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8120, 8096
                        rotation = right
                    ]

                    port Vg_b {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8048, 8096
                        rotation = right
                    ]

                    port Vg_c {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8096
                        rotation = right
                    ]

                    port Ig_c {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8120, 8296
                        rotation = left
                    ]

                    port Ig_b {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8048, 8296
                        rotation = left
                    ]

                    port Ig_a {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8296
                        rotation = left
                    ]

                    port S {
                        position = right:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8352, 8296
                        rotation = right
                    ]

                    port pf {
                        position = right:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8288, 8296
                        rotation = right
                    ]

                    connect P "Power Meter1.Pdc" as Connection11
                    connect "Power Meter1.ia" Ig_a as Connection4
                    connect "Power Meter1.ib" Ig_b as Connection6
                    connect "Power Meter1.ic" Ig_c as Connection3
                    connect "Power Meter1.apparent" S as Connection13
                    connect "Power Meter1.va" Vg_a as Connection2
                    connect "Power Meter1.vb" Vg_b as Connection5
                    connect "Power Meter1.vc" Vg_c as Connection1
                    connect "Power Meter1.k_factor" pf as Connection14
                    connect Q "Power Meter1.Qdc" as Connection12
                    connect Term2.in "Power Meter1.Qac" as Connection9
                    connect Term3.in "Power Meter1.Pac" as Connection10
                }
                [
                    position = 8264, 8184
                    size = 128, 232
                ]

                port va {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8080, 7824
                    rotation = right
                ]

                port vb {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8048, 7856
                    rotation = right
                ]

                port vc {
                    position = left:3
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8016, 7888
                    rotation = right
                ]

                port ia {
                    position = left:4
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8016, 8592
                    rotation = left
                ]

                port ib {
                    position = left:5
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8048, 8552
                    rotation = left
                ]

                port ic {
                    position = left:7
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8080, 8512
                    rotation = left
                ]

                port va_rms {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8296, 7904
                ]

                port vb_rms {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8296, 7960
                ]

                port vc_rms {
                    position = right:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8296, 8016
                ]

                port ia_rms {
                    position = right:8
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8288, 8352
                ]

                port ib_rms {
                    position = right:9
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8288, 8408
                ]

                port ic_rms {
                    position = right:10
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8288, 8464
                ]

                port P {
                    position = right:4
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8392, 8088
                ]

                port Q {
                    position = right:5
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8392, 8152
                ]

                port S {
                    position = right:6
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8392, 8216
                ]

                port pf {
                    position = right:7
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8392, 8280
                ]

                junction Junction347 sp
                [
                    position = 8080, 7904
                ]

                junction Junction348 sp
                [
                    position = 8048, 7960
                ]

                junction Junction349 sp
                [
                    position = 8016, 8016
                ]

                junction Junction350 sp
                [
                    position = 8016, 8352
                ]

                junction Junction351 sp
                [
                    position = 8048, 8408
                ]

                junction Junction352 sp
                [
                    position = 8080, 8464
                ]

                connect Junction347 "Power Measurements.Vg_a" as Connection2624
                connect Junction348 vb as Connection2627
                connect Junction349 vc as Connection2630
                connect Junction350 ia as Connection2636
                connect Junction351 ib as Connection2639
                connect Junction352 RMS8.in as Connection2646
                connect "Power Measurements.Vg_b" Junction348 as Connection2626
                connect "Power Measurements.Vg_c" Junction349 as Connection2629
                connect "Power Measurements.Ig_a" Junction350 as Connection2635
                connect "Power Measurements.Ig_b" Junction351 as Connection2638
                connect "Power Measurements.Ig_c" Junction352 as Connection2647
                connect "Power Measurements.P" P as Connection2606
                connect "Power Measurements.Q" Q as Connection2611
                connect "Power Measurements.S" S as Connection2613
                connect "Power Measurements.pf" pf as Connection2612
                connect RMS3.in Junction349 as Connection2631
                connect RMS3.out vc_rms as Connection2600
                connect RMS4.in Junction347 as Connection2625
                connect RMS4.out va_rms as Connection2604
                connect RMS5.in Junction348 as Connection2628
                connect RMS5.out vb_rms as Connection2605
                connect RMS6.in Junction350 as Connection2637
                connect RMS6.out ia_rms as Connection2610
                connect RMS7.in Junction351 as Connection2640
                connect RMS7.out ib_rms as Connection2609
                connect RMS8.out ic_rms as Connection2607
                connect ic Junction352 as Connection2645
                connect va Junction347 as Connection2623
            }
            [
                position = 10488, 8832
                size = 120, 384
            ]

            component Subsystem "DC Voltage Controller" {
                layout = dynamic
                component gen_sum Sum1 {
                    signs = "+-"
                }
                [
                    position = 8192, 8224
                    hide_name = True
                ]

                component gen_probe "Probe Vdc ref" {
                }
                [
                    position = 8040, 8152
                    rotation = left
                ]

                component "core/DC Energy Calculation" "DC Energy Calculation1" {
                    C_dc = "C_dc/2"
                }
                [
                    position = 8096, 8216
                    hide_name = True
                    size = 48, 48
                ]

                component "core/DC Energy Calculation" "DC Energy Calculation2" {
                    C_dc = "C_dc/2"
                }
                [
                    position = 8096, 8312
                    hide_name = True
                    size = 48, 48
                ]

                component Subsystem "PI with Antiwindup" {
                    layout = dynamic
                    component gen_c_function "C function1" {
                        global_variables = "real enable_old;real sum;"
                        init_fnc = "/*Begin code section*/
sum=0;
enable_old = 0;
/*End code section*/"
                        input_terminals = "real error;inherit enable;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "True;True;"
                        output_fnc = "/*Begin code section*/
if (enable == 0) {
    sum = 0;
    error = 0;
}
//enable_old = enable;
out = ki * sum + kp * error;
if (ki!=0) sum = sum + error;

// Anti windup
if (out > maxout){
    out = maxout;
    if (ki!=0) sum = (out - (kp * error))/ki;
}

// Anti windup
if (out < minout){
    out = minout;
    if (ki!=0) sum = (out - (kp * error))/ki;
}
/*End code section*/"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "True;"
                        parameters = "real kp;real ki;real maxout;real minout;"
                    }
                    [
                        position = 8192, 8192
                        size = 0, 0
                    ]

                    port error {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8144
                    ]

                    port out {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8144
                    ]

                    port enable {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8224
                    ]

                    connect "C function1.error" error as Connection2
                    connect "C function1.out" out as Connection3
                    connect enable "C function1.enable" as Connection4

                    ki = "-2"
                    kp = "-200"
                    maxout = "1000000"
                    minout = "-1000000"

                    mask {
                        description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p></body></html>"

                        kp {
                            label = "Proportional gain"
                            widget = edit
                            type = generic
                            default_value = "0"
                        }

                        ki {
                            label = "Integral gain"
                            widget = edit
                            type = generic
                            default_value = "0"
                        }

                        maxout {
                            label = "Maximum output"
                            widget = edit
                            type = generic
                            default_value = "0"
                        }

                        minout {
                            label = "Minimum output"
                            widget = edit
                            type = generic
                            default_value = "0"
                        }

                        CODE open
                            from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                        
                            dialog = RegularComponentPropertiesDialog(
                                component=component,
                                property_container=component.masks[-1],
                                current_diagram=current_diagram
                            )
                            dialog.exec_()
                            
                        ENDCODE
                    }
                }
                [
                    position = 8328, 8232
                    size = 48, 48
                ]

                port "Vdc ref" {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8008, 8216
                ]

                port Vdc {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8024, 8312
                ]

                port Enable {
                    position = left:3
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8216, 8296
                ]

                port P {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8400, 8232
                ]

                junction Junction1 sp
                [
                    position = 8040, 8216
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Energy used to control voltage indirectly</p></body></html> ENDCOMMENT 
                [
                    position = 8080, 8080
                ]

                connect "DC Energy Calculation1.Vdc" Junction1 as Connection2293
                connect "DC Energy Calculation1.energy" Sum1.in as Connection2291
                connect "DC Energy Calculation2.energy" Sum1.in1 as Connection2297
                connect "DC Energy Calculation2.Vdc" Vdc as Connection2296
                connect Junction1 "Vdc ref" as Connection2294
                connect "PI with Antiwindup.enable" Enable as Connection2290
                connect "PI with Antiwindup.out" P as Connection2289
                connect "PI with Antiwindup.error" Sum1.out as Connection2281
                connect "Probe Vdc ref.in" Junction1 as Connection2295

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">DC Voltage Controller based on DC link energy.</span></p></body></html>"

                    C_dc {
                        label = "DC Link Capacitance"
                        widget = edit
                        type = generic
                        default_value = "18.8e-2/2"
                        unit = "F"
                    }

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 5960, 7512
                size = 112, 88
            ]

            component "core/Three-phase UL 1741 voltage ride-through" "Voltage ride-through" {
                Vnom = "vnom"
            }
            [
                position = 8680, 7376
                size = 120, 88
            ]

            component "core/Voltage Measurement" Vab {
            }
            [
                position = 8416, 8040
                rotation = right
                size = 64, 32
            ]

            component "core/Current Measurement" Ig_c {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 9592, 8184
                size = 64, 32
            ]

            component "core/alfa-beta-gamma to abc" "alfa-beta-gamma to abc1" {
            }
            [
                position = 7576, 7544
                hide_name = True
                size = 56, 112
            ]

            component Subsystem "Modulation and DC balancing" {
                layout = dynamic
                component gen_probe db_down {
                }
                [
                    position = 9288, 8728
                ]

                component gen_probe dc_down {
                }
                [
                    position = 9288, 8808
                ]

                component gen_probe dc_up {
                }
                [
                    position = 9232, 8768
                ]

                component gen_probe da_down {
                }
                [
                    position = 9240, 8544
                ]

                component gen_probe da_up {
                }
                [
                    position = 9296, 8504
                ]

                component gen_c_function "Method 2 (DC balancing control)" {
                    global_variables = "real max;real min;real c1;real c2;real c3;real c4;real c5;real c6;real c7;real c9;real c11;real c8;real c10;real c12;real c13;real vo;real vag_s1;real vbg_s1;real vcg_s1;real vag_vdc2;real vbg_vdc2;real vcg_vdc2;real kp_dc;"
                    init_fnc = "/*Begin code section*/
kp_dc = 1;
vag_s1_l = 0;
vag_s2_l = 0;
vbg_s1_l = 0;
vbg_s2_l = 0;
vcg_s1_l = 0;
vcg_s2_l = 0;
/*End code section*/"
                    input_terminals = "inherit u_a;inherit u_b;inherit u_c;inherit sign_ic_a;inherit sign_ic_b;inherit sign_ic_c;inherit dc_error;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "False;False;False;False;False;False;False;"
                    output_fnc = "/*Begin code section*/
vag_s1_l = u_a;
vbg_s1_l = u_b;
vcg_s1_l = u_c;

c1  = (3. - 2.*vag_s1_l + vbg_s1_l + vcg_s1_l)*0.5;
c3  = (3. + vag_s1_l -2.* vbg_s1_l + vcg_s1_l)*0.5;
c5  = (3. + vag_s1_l + vbg_s1_l - 2.*vcg_s1_l)*0.5;
c7  = (4.*vag_s1_l + vbg_s1_l + vcg_s1_l)*0.5;
c9  = (vag_s1_l + 4.*vbg_s1_l + vcg_s1_l)*0.5;
c11 = (vag_s1_l + vbg_s1_l + 4.*vcg_s1_l)*0.5;

//c2 = c1+1.5;
//c4 = c3+1.5;
//c6 = c5+1.5;
//c8 = c7+1.5;
//c10 = c9+1.5;
//c12 = c11+1.5;

c13 = (3. + vag_s1_l + vbg_s1_l + vcg_s1_l)*0.5;

max = c1;
if (c3>max) max = c3;
if (c5>max) max = c5;
if (c7>max) max = c7;
if (c9>max) max = c9;
if (c11>max) max = c11;

vag_vdc2 = vag_s1_l + 0.5;
vbg_vdc2 = vbg_s1_l + 0.5;
vcg_vdc2 = vcg_s1_l + 0.5;

vag_s1_l = ((2.)*vag_vdc2 + (-1.)*vbg_vdc2 + (-1.)*vcg_vdc2 + (2.)*max)*0.16666667;
vag_s2_l = ((4.)*vag_vdc2 + (1.)*vbg_vdc2 + (1.)*vcg_vdc2 + (-2.)*max)*0.16666667;

vbg_s1_l = ((-1.)*vag_vdc2 + (2.)*vbg_vdc2 + (-1.)*vcg_vdc2 + (2.)*max)*0.16666667;
vbg_s2_l = ((1.)*vag_vdc2 + (4.)*vbg_vdc2 + (1.)*vcg_vdc2 + (-2.)*max)*0.16666667;

vcg_s1_l = ((-1.)*vag_vdc2 + (-1.)*vbg_vdc2 + (2.)*vcg_vdc2 + (2.)*max)*0.16666667;
vcg_s2_l = ((1.)*vag_vdc2 + (1.)*vbg_vdc2 + (4.)*vcg_vdc2 + (-2.)*max)*0.16666667;

if((vag_s1_l > 0.5) && (vag_s2_l < 0.5)){
    vag_s1_l = vag_s1_l + kp_dc*sign_ic_a*dc_error;
    vag_s2_l = vag_s2_l - kp_dc*sign_ic_a*dc_error;
}

if((vbg_s1_l > 0.5) && (vbg_s2_l < 0.5)){
    vbg_s1_l = vbg_s1_l + kp_dc*sign_ic_b*dc_error;
    vbg_s2_l = vbg_s2_l - kp_dc*sign_ic_b*dc_error;
}

if((vcg_s1_l > 0.5) && (vcg_s2_l < 0.5)){
    vcg_s1_l = vcg_s1_l + kp_dc*sign_ic_c*dc_error;
    vcg_s2_l = vcg_s2_l - kp_dc*sign_ic_c*dc_error;
}
/*End code section*/"
                    output_terminals = "inherit vag_s1_l;inherit vag_s2_l;inherit vbg_s1_l;inherit vbg_s2_l;inherit vcg_s1_l;inherit vcg_s2_l;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;False;False;False;"
                }
                [
                    position = 8576, 8632
                    size = 48, 128
                ]

                component gen_limiter "cant be zero for normalization" {
                    lower_limit = "0.0001"
                }
                [
                    position = 7568, 8968
                ]

                component gen_sum "midpoint DC error" {
                    signs = "+-"
                }
                [
                    position = 8408, 8968
                ]

                component src_constant offset {
                    execution_rate = "inherit"
                    value = "0.5"
                }
                [
                    position = 8024, 8528
                ]

                component src_constant "midpoint reference" {
                    execution_rate = "inherit"
                    value = "0.5"
                }
                [
                    position = 8304, 8904
                ]

                component gen_product Normalization2 {
                    signs = "/*"
                }
                [
                    position = 7984, 8976
                ]

                component gen_probe db_up {
                }
                [
                    position = 9296, 8584
                ]

                component Subsystem Saturation {
                    layout = dynamic
                    component gen_limiter Limit2 {
                        lower_limit = "0"
                        upper_limit = "1"
                    }
                    [
                        position = 8408, 8408
                    ]

                    component gen_limiter Limit3 {
                        lower_limit = "0"
                        upper_limit = "1"
                    }
                    [
                        position = 8408, 8464
                    ]

                    component gen_limiter Limit1 {
                        lower_limit = "0"
                        upper_limit = "1"
                    }
                    [
                        position = 8408, 8352
                    ]

                    port in_a {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8352
                    ]

                    port in_b {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8408
                    ]

                    port in_c {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8464
                    ]

                    port out_a {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8352
                    ]

                    port out_b {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8408
                    ]

                    port out_c {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8464
                    ]

                    connect Limit1.in in_a as Connection1
                    connect Limit1.out out_a as Connection2
                    connect Limit2.in in_b as Connection4
                    connect Limit3.out out_c as Connection6
                    connect in_c Limit3.in as Connection5
                    connect out_b Limit2.out as Connection3
                }
                [
                    position = 8240, 8600
                    size = 80, 80
                ]

                component Subsystem Normalization {
                    layout = dynamic
                    component gen_product Product2 {
                        signs = "*/"
                    }
                    [
                        position = 8560, 8416
                        hide_name = True
                    ]

                    component gen_product Product3 {
                        signs = "*/"
                    }
                    [
                        position = 8496, 8472
                        hide_name = True
                    ]

                    component gen_product Product1 {
                        signs = "*/"
                    }
                    [
                        position = 8616, 8360
                        hide_name = True
                    ]

                    port in_a {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8352
                    ]

                    port in_b {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8408
                    ]

                    port in_c {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8464
                    ]

                    port out_a {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8360
                    ]

                    port out_b {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8416
                    ]

                    port out_c {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8472
                    ]

                    port Vdc {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8384, 8560
                    ]

                    junction Junction1 sp
                    [
                        position = 8416, 8424
                    ]

                    junction Junction2 sp
                    [
                        position = 8416, 8480
                    ]

                    connect Junction1 Junction2 as Connection70
                    connect Junction2 Vdc as Connection71
                    connect Product1.in1 Junction1 as Connection67
                    connect Product1.in in_a as Connection63
                    connect Product1.out out_a as Connection59
                    connect Product2.in1 Junction1 as Connection69
                    connect Product3.in1 Junction2 as Connection72
                    connect in_b Product2.in as Connection64
                    connect in_c Product3.in as Connection65
                    connect out_b Product2.out as Connection61
                    connect out_c Product3.out as Connection62
                }
                [
                    position = 7784, 8600
                    size = 80, 80
                ]

                component Subsystem "add offset" {
                    layout = dynamic
                    component gen_sum Sum4 {
                    }
                    [
                        position = 8504, 8472
                        hide_name = True
                    ]

                    component gen_sum Sum2 {
                    }
                    [
                        position = 8608, 8360
                        hide_name = True
                    ]

                    component gen_sum Sum3 {
                    }
                    [
                        position = 8560, 8416
                        hide_name = True
                    ]

                    port in_a {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8368
                    ]

                    port in_b {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8424
                    ]

                    port in_c {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8480
                    ]

                    port out_a {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8360
                    ]

                    port out_b {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8416
                    ]

                    port out_c {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8472
                    ]

                    port offset {
                        position = top:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8384, 8272
                    ]

                    junction Junction9 sp
                    [
                        position = 8464, 8408
                    ]

                    junction Junction10 sp
                    [
                        position = 8464, 8352
                    ]

                    connect Junction10 Junction9 as Connection56
                    connect Junction9 Sum4.in as Connection39
                    connect Sum2.in Junction10 as Connection55
                    connect Sum2.in1 in_a as Connection48
                    connect Sum3.in Junction9 as Connection40
                    connect Sum4.in1 in_c as Connection47
                    connect in_b Sum3.in1 as Connection49
                    connect offset Junction10 as Connection57
                    connect out_a Sum2.out as Connection44
                    connect out_b Sum3.out as Connection45
                    connect out_c Sum4.out as Connection46
                }
                [
                    position = 8104, 8600
                    size = 96, 80
                ]

                component Subsystem "Triplen Harm Zero seq injection" {
                    layout = dynamic
                    component gen_sum Sum2 {
                        signs = "-+"
                    }
                    [
                        position = 8608, 8360
                        hide_name = True
                    ]

                    component gen_sum Sum4 {
                        signs = "-+"
                    }
                    [
                        position = 8504, 8472
                        hide_name = True
                    ]

                    component gen_minmax "Min Max2" {
                        inputs = "3"
                        operation = "max"
                    }
                    [
                        position = 8232, 8232
                    ]

                    component gen_gain Gain1 {
                        gain = "0.5"
                    }
                    [
                        position = 8384, 8168
                        hide_name = True
                    ]

                    component gen_sum Sum1 {
                    }
                    [
                        position = 8312, 8168
                        hide_name = True
                    ]

                    component gen_sum Sum3 {
                        signs = "-+"
                    }
                    [
                        position = 8560, 8416
                        hide_name = True
                    ]

                    component gen_minmax "Min Max1" {
                        inputs = "3"
                    }
                    [
                        position = 8232, 8104
                    ]

                    port in_a {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8368
                    ]

                    port in_b {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8424
                    ]

                    port in_c {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8480
                    ]

                    port out_a {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8360
                    ]

                    port out_b {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8416
                    ]

                    port out_c {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8704, 8472
                    ]

                    junction Junction3 sp
                    [
                        position = 8072, 8248
                    ]

                    junction Junction4 sp
                    [
                        position = 8032, 8232
                    ]

                    junction Junction5 sp
                    [
                        position = 8000, 8216
                    ]

                    junction Junction6 sp
                    [
                        position = 8000, 8368
                    ]

                    junction Junction7 sp
                    [
                        position = 8032, 8424
                    ]

                    junction Junction8 sp
                    [
                        position = 8072, 8480
                    ]

                    junction Junction9 sp
                    [
                        position = 8464, 8408
                    ]

                    junction Junction10 sp
                    [
                        position = 8464, 8352
                    ]

                    connect Gain1.out Junction10 as Connection41
                    connect Gain1.in Sum1.out as Connection15
                    connect Junction10 Junction9 as Connection42
                    connect Junction3 "Min Max1.in2" as Connection11
                    connect Junction4 "Min Max2.in1" as Connection23
                    connect Junction5 Junction6 as Connection28
                    connect Junction6 in_a as Connection29
                    connect Junction7 Junction4 as Connection32
                    connect Junction8 Junction3 as Connection35
                    connect Junction9 Sum4.in as Connection39
                    connect "Min Max1.in1" Junction4 as Connection24
                    connect "Min Max1.in" Junction5 as Connection27
                    connect "Min Max1.out" Sum1.in as Connection13
                    connect "Min Max2.in2" Junction3 as Connection12
                    connect "Min Max2.in" Junction5 as Connection25
                    connect "Min Max2.out" Sum1.in1 as Connection14
                    connect Sum2.in Junction10 as Connection43
                    connect Sum2.in1 Junction6 as Connection30
                    connect Sum3.in1 Junction7 as Connection33
                    connect Sum3.in Junction9 as Connection40
                    connect Sum4.in1 Junction8 as Connection36
                    connect in_b Junction7 as Connection31
                    connect in_c Junction8 as Connection34
                    connect out_a Sum2.out as Connection44
                    connect out_b Sum3.out as Connection45
                    connect out_c Sum4.out as Connection46
                }
                [
                    position = 7928, 8600
                    size = 80, 64
                ]

                component Subsystem "Transport delay" {
                    layout = dynamic
                    component gen_delay Delay6 {
                        del_length = "1"
                    }
                    [
                        position = 8072, 8232
                        hide_name = True
                    ]

                    component gen_delay Delay5 {
                        del_length = "1"
                    }
                    [
                        position = 8120, 8216
                        hide_name = True
                    ]

                    component gen_delay Delay2 {
                        del_length = "1"
                    }
                    [
                        position = 8264, 8168
                        hide_name = True
                    ]

                    component gen_delay Delay3 {
                        del_length = "1"
                    }
                    [
                        position = 8216, 8184
                        hide_name = True
                    ]

                    component gen_delay Delay4 {
                        del_length = "1"
                    }
                    [
                        position = 8168, 8200
                        hide_name = True
                    ]

                    component gen_delay Delay1 {
                        del_length = "1"
                    }
                    [
                        position = 8312, 8152
                        hide_name = True
                    ]

                    port Out1 {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8384, 8152
                    ]

                    port Out2 {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8168
                    ]

                    port Out3 {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8288, 8184
                    ]

                    port Out4 {
                        position = right:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 8200
                    ]

                    port Out5 {
                        position = right:5
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8192, 8216
                    ]

                    port Out6 {
                        position = right:6
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8144, 8232
                    ]

                    port In7 {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 8152
                    ]

                    port In8 {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8192, 8168
                    ]

                    port In9 {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8144, 8184
                    ]

                    port In10 {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8096, 8200
                    ]

                    port In11 {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8048, 8216
                    ]

                    port In12 {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8000, 8232
                    ]

                    connect Delay1.in In7 as Connection3
                    connect Delay1.out Out1 as Connection4
                    connect Delay2.in In8 as Connection7
                    connect Delay2.out Out2 as Connection6
                    connect Delay3.in In9 as Connection11
                    connect Delay3.out Out3 as Connection8
                    connect Delay4.in In10 as Connection2
                    connect Delay4.out Out4 as Connection12
                    connect Delay5.in In11 as Connection9
                    connect Delay5.out Out5 as Connection1
                    connect Delay6.in In12 as Connection10
                    connect Delay6.out Out6 as Connection5
                }
                [
                    position = 9000, 8632
                    size = 128, 120
                ]

                component Subsystem "adjust range for PWM" {
                    layout = dynamic
                    component gen_gain Gain6 {
                        gain = "2"
                    }
                    [
                        position = 8272, 8648
                        hide_name = True
                    ]

                    component gen_gain Gain4 {
                        gain = "2"
                    }
                    [
                        position = 8272, 8536
                        hide_name = True
                    ]

                    component gen_limiter Limit12 {
                        lower_limit = "0"
                        upper_limit = "0.5"
                    }
                    [
                        position = 7896, 8648
                    ]

                    component gen_gain Gain2 {
                        gain = "2"
                    }
                    [
                        position = 8272, 8416
                        hide_name = True
                    ]

                    component gen_limiter Limit8 {
                        lower_limit = "0.5"
                        upper_limit = "1"
                    }
                    [
                        position = 7720, 8480
                    ]

                    component gen_sum Sum4 {
                        signs = "-+"
                    }
                    [
                        position = 8136, 8472
                        hide_name = True
                    ]

                    component gen_sum Sum5 {
                        signs = "-+"
                    }
                    [
                        position = 8136, 8592
                        hide_name = True
                    ]

                    component gen_gain Gain3 {
                        gain = "2"
                    }
                    [
                        position = 8272, 8472
                        hide_name = True
                    ]

                    component gen_gain Gain1 {
                        gain = "2"
                    }
                    [
                        position = 8272, 8360
                        hide_name = True
                    ]

                    component gen_limiter Limit11 {
                        lower_limit = "0"
                        upper_limit = "0.5"
                    }
                    [
                        position = 7896, 8536
                    ]

                    component gen_limiter Limit10 {
                        lower_limit = "0"
                        upper_limit = "0.5"
                    }
                    [
                        position = 7896, 8416
                    ]

                    component gen_limiter Limit9 {
                        lower_limit = "0.5"
                        upper_limit = "1"
                    }
                    [
                        position = 7720, 8600
                    ]

                    component gen_sum Sum2 {
                        signs = "-+"
                    }
                    [
                        position = 8136, 8360
                        hide_name = True
                    ]

                    component src_constant Constant {
                        execution_rate = "inherit"
                        value = "0.5"
                    }
                    [
                        position = 8136, 8280
                        scale = -1, 1
                    ]

                    component gen_gain Gain5 {
                        gain = "2"
                    }
                    [
                        position = 8272, 8592
                        hide_name = True
                    ]

                    component gen_limiter Limit7 {
                        lower_limit = "0.5"
                        upper_limit = "1"
                    }
                    [
                        position = 7720, 8368
                    ]

                    port in_a2 {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7568, 8416
                    ]

                    port in_b2 {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7568, 8536
                    ]

                    port in_c2 {
                        position = left:7
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7568, 8648
                    ]

                    port out_a1 {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8368, 8360
                    ]

                    port out_b1 {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8368, 8472
                    ]

                    port out_c1 {
                        position = right:5
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8368, 8592
                    ]

                    port out_a2 {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8368, 8416
                    ]

                    port out_b2 {
                        position = right:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8368, 8536
                    ]

                    port out_c2 {
                        position = right:6
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8368, 8648
                    ]

                    port in_a1 {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7568, 8368
                    ]

                    port in_b1 {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7568, 8480
                    ]

                    port in_c1 {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7568, 8600
                    ]

                    junction Junction3 sp
                    [
                        position = 8016, 8464
                    ]

                    junction Junction4 sp
                    [
                        position = 8016, 8352
                    ]

                    comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Bring the upper</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">halfs down to</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(0-0.5)</p></body></html> ENDCOMMENT 
                    [
                        position = 8080, 8192
                    ]

                    comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">signals between</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(0-1)</p></body></html> ENDCOMMENT 
                    [
                        position = 7536, 8296
                    ]

                    comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">limit upper half</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">between</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(0.5-1)</p></body></html> ENDCOMMENT 
                    [
                        position = 7688, 8280
                    ]

                    comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Gain so upper halfs</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">and lower halfs are</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">between (0,1)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Now each half can be</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">compared to the</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">modulator carrier,</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">which is between</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(0,1)</p></body></html> ENDCOMMENT 
                    [
                        position = 8256, 8128
                    ]

                    comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">limit lower half</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">between</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">(0-0.5)</p></body></html> ENDCOMMENT 
                    [
                        position = 7856, 8288
                    ]

                    connect Constant.out Junction4 as Connection119
                    connect Gain1.out out_a1 as Connection141
                    connect Gain2.out out_a2 as Connection143
                    connect Gain3.out out_b1 as Connection145
                    connect Gain4.out out_b2 as Connection147
                    connect Gain5.out out_c1 as Connection149
                    connect Gain6.out out_c2 as Connection151
                    connect Junction3 Sum5.in as Connection112
                    connect Junction4 Junction3 as Connection118
                    connect Limit10.out Gain2.in as Connection142
                    connect Limit11.out Gain4.in as Connection146
                    connect Limit12.out Gain6.in as Connection150
                    connect Limit7.out Sum2.in1 as Connection131
                    connect Limit7.in in_a1 as Connection121
                    connect Limit8.out Sum4.in1 as Connection132
                    connect Limit9.out Sum5.in1 as Connection133
                    connect Sum2.out Gain1.in as Connection140
                    connect Sum2.in Junction4 as Connection117
                    connect Sum4.out Gain3.in as Connection144
                    connect Sum4.in Junction3 as Connection91
                    connect Sum5.out Gain5.in as Connection148
                    connect in_a2 Limit10.in as Connection126
                    connect in_b1 Limit8.in as Connection122
                    connect in_b2 Limit11.in as Connection128
                    connect in_c1 Limit9.in as Connection124
                    connect in_c2 Limit12.in as Connection130
                }
                [
                    position = 8776, 8632
                    size = 136, 112
                ]

                port u_a {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7704, 8488
                    rotation = right
                ]

                port u_b {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7672, 8520
                    rotation = right
                ]

                port u_c {
                    position = left:3
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7648, 8560
                    rotation = right
                ]

                port Vdc {
                    position = left:4
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7448, 8968
                ]

                port Vdc_half {
                    position = left:5
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7872, 9056
                    rotation = left
                ]

                port "a high" {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9096, 8392
                    rotation = left
                ]

                port "a low" {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9128, 8424
                    rotation = left
                ]

                port "b high" {
                    position = right:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9160, 8456
                    rotation = left
                ]

                port "b low" {
                    position = right:4
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9160, 8944
                    rotation = right
                ]

                port "c high" {
                    position = right:5
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9128, 8904
                    rotation = right
                ]

                port "c low" {
                    position = right:6
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9096, 8864
                    rotation = right
                ]

                port sign_ic_a {
                    position = left:6
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8312, 8824
                    rotation = left
                ]

                port sign_ic_b {
                    position = left:7
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8336, 8792
                    rotation = left
                ]

                port sign_ic_c {
                    position = left:8
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8368, 8760
                    rotation = left
                ]

                junction Junction2 sp
                [
                    position = 9128, 8544
                ]

                junction Junction5 sp
                [
                    position = 9128, 8768
                ]

                junction Junction73 sp
                [
                    position = 7696, 8968
                ]

                junction Junction74 sp
                [
                    position = 9160, 8728
                ]

                junction Junction75 sp
                [
                    position = 9096, 8808
                ]

                junction Junction76 sp
                [
                    position = 9160, 8584
                ]

                junction Junction77 sp
                [
                    position = 9096, 8504
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1 sample transport delay, simulating DSP behavior</p></body></html> ENDCOMMENT 
                [
                    position = 8680, 8504
                ]

                connect Junction2 "Transport delay.Out2" as Connection2607
                connect Junction2 "a low" as Connection1834
                connect Junction5 "Transport delay.Out5" as Connection2602
                connect Junction5 "c high" as Connection1843
                connect Junction73 Normalization2.in as Connection2515
                connect Junction74 "b low" as Connection2616
                connect Junction75 dc_down.in as Connection2620
                connect Junction76 "b high" as Connection2624
                connect Junction77 da_up.in as Connection2628
                connect "Method 2 (DC balancing control).u_a" Saturation.out_a as Connection2592
                connect "Method 2 (DC balancing control).u_b" Saturation.out_b as Connection2593
                connect "Method 2 (DC balancing control).u_c" Saturation.out_c as Connection2594
                connect "Method 2 (DC balancing control).vag_s1_l" "adjust range for PWM.in_a1" as Connection2596
                connect "Method 2 (DC balancing control).vag_s2_l" "adjust range for PWM.in_a2" as Connection2597
                connect "Method 2 (DC balancing control).vbg_s2_l" "adjust range for PWM.in_b2" as Connection2599
                connect "Method 2 (DC balancing control).vbg_s1_l" "adjust range for PWM.in_b1" as Connection2598
                connect "Method 2 (DC balancing control).vcg_s2_l" "adjust range for PWM.in_c2" as Connection2601
                connect "Method 2 (DC balancing control).vcg_s1_l" "adjust range for PWM.in_c1" as Connection2600
                connect "Method 2 (DC balancing control).dc_error" "midpoint DC error.out" as Connection2595
                connect Normalization.Vdc Junction73 as Connection2516
                connect Normalization.out_c "Triplen Harm Zero seq injection.in_c" as Connection2510
                connect Normalization.out_b "Triplen Harm Zero seq injection.in_b" as Connection2509
                connect Normalization.out_a "Triplen Harm Zero seq injection.in_a" as Connection2508
                connect Normalization2.out "midpoint DC error.in1" as Connection2296
                connect Saturation.in_a "add offset.out_a" as Connection2531
                connect "Transport delay.Out4" Junction74 as Connection2617
                connect "Transport delay.Out6" Junction75 as Connection2621
                connect "Transport delay.Out3" Junction76 as Connection2625
                connect "Transport delay.Out1" Junction77 as Connection2629
                connect Vdc_half Normalization2.in1 as Connection2304
                connect "a high" Junction77 as Connection2627
                connect "add offset.out_b" Saturation.in_b as Connection2532
                connect "add offset.out_c" Saturation.in_c as Connection2533
                connect "add offset.in_b" "Triplen Harm Zero seq injection.out_b" as Connection2503
                connect "add offset.in_c" "Triplen Harm Zero seq injection.out_c" as Connection2505
                connect "add offset.in_a" "Triplen Harm Zero seq injection.out_a" as Connection2501
                connect "adjust range for PWM.out_c1" "Transport delay.In11" as Connection2610
                connect "adjust range for PWM.out_b1" "Transport delay.In9" as Connection2612
                connect "adjust range for PWM.out_b2" "Transport delay.In10" as Connection2603
                connect "adjust range for PWM.out_a1" "Transport delay.In7" as Connection2604
                connect "adjust range for PWM.out_c2" "Transport delay.In12" as Connection2611
                connect "adjust range for PWM.out_a2" "Transport delay.In8" as Connection2608
                connect "c low" Junction75 as Connection2619
                connect "cant be zero for normalization.out" Junction73 as Connection2514
                connect "cant be zero for normalization.in" Vdc as Connection2327
                connect da_down.in Junction2 as Connection1835
                connect db_down.in Junction74 as Connection2615
                connect db_up.in Junction76 as Connection2623
                connect dc_up.in Junction5 as Connection1844
                connect "midpoint reference.out" "midpoint DC error.in" as Connection2299
                connect offset.out "add offset.offset" as Connection2506
                connect sign_ic_a "Method 2 (DC balancing control).sign_ic_a" as Connection2565
                connect sign_ic_b "Method 2 (DC balancing control).sign_ic_b" as Connection2566
                connect sign_ic_c "Method 2 (DC balancing control).sign_ic_c" as Connection2567
                connect u_a Normalization.in_a as Connection2511
                connect u_b Normalization.in_b as Connection2512
                connect u_c Normalization.in_c as Connection2513
            }
            [
                position = 8008, 7624
                size = 88, 312
            ]

            component "core/Current Measurement" Ig_a {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 9592, 7992
                size = 64, 32
            ]

            component "core/Voltage Measurement" vc_a {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 8848, 8040
                rotation = right
                size = 64, 32
            ]

            component "core/Current Measurement" Ic_b {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 8512, 8088
                size = 64, 32
            ]

            component "core/abc to alfa-beta-gamma" "abc to alfa-beta-gamma1" {
            }
            [
                position = 9184, 8616
                hide_name = True
                size = 48, 88
            ]

            component "core/Voltage Measurement" V_dc_1 {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 7880, 8136
                rotation = right
                size = 64, 32
            ]

            component "core/Three Phase Core Coupling" "Core Coupling 2" {
            }
            [
                position = 8744, 8088
                scale = -1, 1
                size = 12, 256
            ]

            component "core/Current Measurement" Ic_c {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 8512, 8184
                size = 64, 32
            ]

            component "core/Voltage Measurement" vg_b {
                execution_rate = "inherit"
                sig_output = "True"
            }
            [
                position = 10304, 8312
                rotation = right
                size = 64, 32
            ]

            component Subsystem "Startup and Shutdown Ramping" {
                layout = dynamic
                component gen_c_function "Inverter startup" {
                    global_variables = "real enable_ant;real count;real ramp;real Fs;"
                    init_fnc = "/*Begin code section*/
count=0;
ramp=0;
enable_ant=0;
Fs = 1/execution_rate;

operating=0;
inv_enable = 0;
ref_control = 0;
/*End code section*/"
                    input_terminals = "real enable;"
                    input_terminals_dimensions = "inherit"
                    input_terminals_feedthrough = "[\'\']"
                    output_fnc = "/*Begin code section*/
if (enable==1) inv_enable=1;

if (enable-enable_ant > 0) // 0 -> 1 enable
{
    ramp = 1.;
    count = 0.;
} else if (enable-enable_ant < 0) // 1 -> 0 desable
{
    count = t*Fs;
    ramp = -1.;
}

count = count + ramp;

if (count>t*Fs) {
    count = t*Fs;
    ramp = 0;
}
if (count<0.) {
    count = 0.;
    ramp = 0;
    inv_enable = 0;
}

enable_ant = enable;
ref_control = count/(t*Fs);

if (ramp == 0 && inv_enable==1) operating = 1;
else    operating = 0;
/*End code section*/"
                    output_terminals = "real ref_control;inherit inv_enable;inherit operating;"
                    output_terminals_dimensions = "inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;"
                    parameters = "real t;"
                }
                [
                    position = 8192, 8192
                    size = 48, 64
                ]

                port enable {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8072, 8192
                ]

                port "switching enable" {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8352, 8192
                ]

                port "ref control" {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8280, 8120
                    rotation = left
                ]

                port operating {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8280, 8288
                    rotation = right
                ]

                connect "Inverter startup.enable" enable as Connection2
                connect "Inverter startup.operating" operating as Connection14
                connect "Inverter startup.inv_enable" "switching enable" as Connection4
                connect "ref control" "Inverter startup.ref_control" as Connection13

                t = "1"

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Controls switching start and stop, issuing a control signal to ramp up (start up) and down (shutdown) the set-points in the converter.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Also zeroes setpoints in case of a ride-through momentary cessation</span></p></body></html>"

                    t {
                        label = "Ramp time"
                        widget = edit
                        type = generic
                        default_value = "0.1"
                        unit = "s"
                    }

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 9304, 7552
                size = 136, 88
            ]

            component Subsystem "LCL filter model" {
                layout = dynamic
                component gen_bus_join "plant model states" {
                    inputs = "6"
                }
                [
                    position = 8320, 8192
                ]

                component gen_c_function "Plant model" {
                    global_variables = "real ic_al_m;real ic_be_m;real vc_al_m;real vc_be_m;real ig_al_m;real ig_be_m;real Ad11;real Ad12;real Ad13;real Ad21;real Ad22;real Ad23;real Ad31;real Ad32;real Ad33;real Bd11;real Bd21;real Bd31;real Fd11;real Fd21;real Fd31;real u_al;real u_be;"
                    init_fnc = "/*Begin code section*/
// Plant model when inverter off
/*
Ad11 = 0.84238926;
Ad12 = -1.78506869;
Ad13 = 0.15761074;

Ad21 = 0.14875572;
Ad22 = 0.68477853;
Ad23 = -0.14875572;

Ad31 = 0.15761074;
Ad32 = 1.78506869;
Ad33 = 0.84238926;

Bd11 = 1.89253434;
Bd21 = 0.15761074;
Bd31 = 0.10746566;

Fd11 = -0.10746566;
Fd21 =  0.15761074;
Fd31 = -1.89253434;

/// With r1 = 0.1

Ad11 = 0.6809047;
Ad12 = -1.61311001;
Ad13 = 0.14755423;

Ad21 = 0.13442583;
Ad22 = 0.69466147;
Ad23 = -0.14918126;

Ad31 = 0.14755423;
Ad32 = 1.79017509;
Ad33 = 0.8422157;

Bd11 = 1.71541067;
Bd21 = 0.14755423;
Bd31 = 0.10230066;

Fd11 = -0.10230066;
Fd21 =  0.1577843;
Fd31 = -1.89247575;
*/
// Fs = 5000 Hz

Ad11 = 0.46892163;
Ad12 = -2.44475341;
Ad13 = 0.53107837;

Ad21 = 0.20372945;
Ad22 = -0.06215674;
Ad23 = -0.20372945;

Ad31 = 0.53107837;
Ad32 = 2.44475341;
Ad33 = 0.46892163;

Bd11 = 3.22237671;
Bd21 = 0.53107837;
Bd31 = 0.77762329;

Fd11 = -0.77762329;
Fd21 =  0.53107837;
Fd31 = -3.22237671;

/*// Fs = 5000 Hz, r1=0.1

Ad11 = 2.68559801e-01;
Ad12 = -1.95479164e+00;
Ad13 = 4.65388646e-01;

Ad21 = 1.62899303e-01;
Ad22 = -1.34968111e-03;
Ad23 = -2.09438168e-01;

Ad31 = 4.65388646e-01;
Ad32 = 2.51325801e+00;
Ad33 = 4.64038964e-01;

Bd11 = 2.66051554;
Bd21 = 0.46538865;
Bd31 = 0.7057239;

Fd11 = -0.7057239;
Fd21 =  0.53596104;
Fd31 = -3.21898191;
*/
ic_al_m=0.;
vc_be_m=0.;

vc_al_m=0.;
ic_be_m=0.;

ig_al_m=0.;
ig_be_m=0.;

u_al_m=0;
u_be_m=0;

ig_al=0.;
ig_be=0.;

u_al=0.;
u_be=0.;
/*End code section*/"
                    input_terminals = "inherit u_al_m;inherit u_be_m;inherit vr_al;inherit vr_be;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\', \'u_al_m\', \'u_be_m\']"
                    input_terminals_show_labels = "False;False;False;False;"
                    output_fnc = "/*Begin code section*/
ic_al = ic_al_m;
ic_be = ic_be_m;

vc_al = vc_al_m;
vc_be = vc_be_m;

ig_al = ig_al_m;
ig_be = ig_be_m;

u_al = u_al_m;
u_be = u_be_m;

ic_al_m = Ad11*ic_al + Ad12* vc_al + Ad13* ig_al + Bd11* u_al + Fd11*vr_al;
vc_al_m = Ad21*ic_al + Ad22* vc_al + Ad23* ig_al + Bd21* u_al + Fd21*vr_al;
ig_al_m = Ad31*ic_al + Ad32* vc_al + Ad33* ig_al + Bd31* u_al + Fd31*vr_al;

ic_be_m = Ad11*ic_be + Ad12* vc_be + Ad13* ig_be + Bd11* u_be + Fd11*vr_be;
vc_be_m = Ad21*ic_be + Ad22* vc_be + Ad23* ig_be + Bd21* u_be + Fd21*vr_be;
ig_be_m = Ad31*ic_be + Ad32* vc_be + Ad33* ig_be + Bd31* u_be + Fd31*vr_be;
/*End code section*/"
                    output_terminals = "inherit ig_al;inherit ig_be;inherit ic_al;inherit ic_be;inherit vc_al;inherit vc_be;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "False;False;False;False;False;False;"
                }
                [
                    position = 8080, 8192
                    size = 0, 0
                ]

                port states {
                    position = top:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8464, 8192
                ]

                port u_alpha {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8016, 8096
                    rotation = right
                ]

                port u_beta {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7936, 8128
                    rotation = right
                ]

                port vg_alpha {
                    position = right:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7936, 8272
                    rotation = left
                ]

                port vg_beta {
                    position = right:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8016, 8312
                    rotation = left
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Outputs</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">0 - ig_alpha</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1 - ig_beta</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2 - ic_alpha</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3 - ic_beta</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4 - vc_alpha</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">5 - vc_beta</p></body></html> ENDCOMMENT 
                [
                    position = 8136, 7984
                ]

                connect "Plant model.ic_al" "plant model states.in2" as Connection2152
                connect "Plant model.vc_al" "plant model states.in4" as Connection2154
                connect "Plant model.vc_be" "plant model states.in5" as Connection2155
                connect "Plant model.ig_be" "plant model states.in1" as Connection2142
                connect "Plant model.ic_be" "plant model states.in3" as Connection2153
                connect "Plant model.ig_al" "plant model states.in" as Connection2141
                connect "Plant model.u_al_m" u_alpha as Connection2150
                connect "Plant model.u_be_m" u_beta as Connection2149
                connect "Plant model.vr_al" vg_alpha as Connection2147
                connect "Plant model.vr_be" vg_beta as Connection2148
                connect "plant model states.out" states as Connection2151

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">This is a model of the LCL filter to be used for proper control initialization even if converter is disabled.</span></p></body></html>"

                    CODE define_icon
                        mdl.set_component_icon_image(item_handle, "lcl_filter.svg")
                    ENDCODE

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 9456, 9312
                size = 384, 216
            ]

            component "core/Three Phase NPC Inverter" Inverter {
                carrier_freq = "10000"
                ctrl_src = "Internal modulator separated"
                d_time = "0"
                fvd_def_method_g1 = "LUT"
                fvd_def_method_g2 = "LUT"
                fvd_def_method_g3 = "LUT"
                ref_sig_min_max = "[0.0,1.0]"
            }
            [
                position = 8240, 8088
                size = 127, 256
            ]

            component gen_bus_join "Bus Join2" {
            }
            [
                position = 8112, 7528
                hide_name = True
            ]

            component gen_bus_join "Bus Join3" {
            }
            [
                position = 8112, 7624
                hide_name = True
            ]

            component gen_bus_join "Bus Join4" {
            }
            [
                position = 8112, 7720
                hide_name = True
            ]

            component src_scada_input "NPC enable" {
                execution_rate = "inherit"
                unit = ""
            }
            [
                position = 5952, 6744
            ]

            component src_scada_input Qsign {
                execution_rate = "inherit"
                unit = ""
            }
            [
                position = 6016, 6848
            ]

            component src_scada_input "pf ref" {
                execution_rate = "inherit"
                unit = ""
            }
            [
                position = 5952, 6816
            ]

            component src_scada_input Priority {
                execution_rate = "inherit"
                unit = ""
            }
            [
                position = 6016, 6776
            ]

            component gen_bus_split "Bus Split2" {
                outputs = "19"
            }
            [
                position = 6784, 6552
                rotation = left
                hide_name = True
            ]

            component gen_probe Vdc_total {
            }
            [
                position = 6984, 5976
            ]

            component gen_probe Vdc_half {
            }
            [
                position = 7088, 6008
            ]

            component gen_digital_probe precharging_contactor {
            }
            [
                position = 6984, 6040
            ]

            component gen_digital_probe main_contactor {
            }
            [
                position = 7088, 6064
            ]

            component gen_digital_probe operating {
            }
            [
                position = 6984, 6096
            ]

            component gen_digital_probe FRT_inv_enable {
            }
            [
                position = 7088, 6120
            ]

            component gen_digital_probe VRT_inv_enable {
            }
            [
                position = 6984, 6152
            ]

            component gen_digital_probe VRT_ref_enable {
            }
            [
                position = 7088, 6176
            ]

            component gen_probe Va_rms {
            }
            [
                position = 6984, 6200
            ]

            component gen_probe Vb_rms {
            }
            [
                position = 7088, 6232
            ]

            component gen_probe Vc_rms {
            }
            [
                position = 6984, 6256
            ]

            component gen_probe Ia_rms {
            }
            [
                position = 7088, 6288
            ]

            component gen_probe Ib_rms {
            }
            [
                position = 6984, 6312
            ]

            component gen_probe Ic_rms {
            }
            [
                position = 7088, 6344
            ]

            component gen_probe f {
            }
            [
                position = 6984, 6368
            ]

            component gen_probe P {
            }
            [
                position = 7088, 6400
            ]

            component gen_probe Q {
            }
            [
                position = 6984, 6424
            ]

            component gen_probe S {
            }
            [
                position = 7088, 6456
            ]

            component gen_probe pf {
            }
            [
                position = 6984, 6480
            ]

            port A {
                position = 144.0, -96.0
                kind = pe
            }
            [
                position = 10744, 7992
                rotation = down
            ]

            port B {
                position = 144.0, -0.1
                kind = pe
            }
            [
                position = 10744, 8088
                rotation = down
            ]

            port C {
                position = 144.0, 96.0
                kind = pe
            }
            [
                position = 10744, 8184
                rotation = down
            ]

            port N {
                position = -0.1, 120.0
                kind = pe
            }
            [
                position = 10752, 8424
                rotation = down
            ]

            port DCpos {
                position = -144.0, -96.0
                kind = pe
            }
            [
                position = 7656, 7992
                rotation = down
                scale = -1, 1
            ]

            port DCneg {
                position = -144.0, 96.0
                kind = pe
            }
            [
                position = 7656, 8184
                rotation = down
                scale = -1, 1
            ]

            tag Goto31 {
                value = "VRT inv enable"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8904, 7400
                hide_name = True
                size = 104, 20
            ]

            tag From56 {
                value = "VRT ref enable"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6576, 7352
                hide_name = True
                size = 97, 20
            ]

            tag From60 {
                value = "vpc_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8504, 7400
                hide_name = True
                size = 60, 20
            ]

            tag From69 {
                value = "Vdc_1"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 6784
                hide_name = True
                size = 60, 20
            ]

            tag From27 {
                value = "f"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8296, 8552
                hide_name = True
                size = 60, 20
            ]

            tag From76 {
                value = "VRT inv enable"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6568, 6904
                hide_name = True
                size = 120, 20
            ]

            tag From85 {
                value = "P"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7120
                hide_name = True
                size = 60, 20
            ]

            tag Goto22 {
                value = "ramping"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9528, 7528
                hide_name = True
                size = 104, 20
            ]

            tag "to Controller6" {
                value = "va_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8688
                hide_name = True
                size = 60, 20
            ]

            tag From77 {
                value = "VRT ref enable"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6568, 6928
                hide_name = True
                size = 120, 20
            ]

            tag From31 {
                value = "Ic_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7736, 7784
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller9" {
                value = "P"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8784
                hide_name = True
                size = 60, 20
            ]

            tag From71 {
                value = "contactor"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6560, 6832
                hide_name = True
                size = 105, 20
            ]

            tag From8 {
                value = "Ic_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7736, 7744
                hide_name = True
                size = 58, 20
            ]

            tag Goto14 {
                value = "f"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8632, 8440
                hide_name = True
                size = 32, 20
            ]

            tag "to Controller8" {
                value = "vb_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8720
                hide_name = True
                size = 60, 20
            ]

            tag Goto6 {
                value = "vg_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10472, 8360
                hide_name = True
                size = 60, 20
            ]

            tag Goto23 {
                value = "VRT ref enable"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8904, 7352
                hide_name = True
                size = 104, 20
            ]

            tag From80 {
                value = "vb_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 6976
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller7" {
                value = "vc_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8752
                hide_name = True
                size = 60, 20
            ]

            tag From15 {
                value = "vc_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8888
                hide_name = True
                size = 60, 20
            ]

            tag From62 {
                value = "u_al"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9128, 9224
                hide_name = True
                size = 60, 20
            ]

            tag From3 {
                value = "vg_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10328, 8800
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller4" {
                value = "vp_al"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8728, 8552
                hide_name = True
                size = 60, 20
            ]

            tag From14 {
                value = "vc_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8864
                hide_name = True
                size = 60, 20
            ]

            tag Goto9 {
                value = "Ic_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8624, 8048
                hide_name = True
                size = 60, 20
            ]

            tag Goto12 {
                value = "vc_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8968, 8136
                hide_name = True
                size = 60, 20
            ]

            tag Goto19 {
                value = "Vdc_1"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7840, 8216
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From48 {
                value = "enable-inv"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9664, 9000
                hide_name = True
                scale = -1, 1
                size = 96, 20
            ]

            tag From75 {
                value = "FRT inv enable"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6568, 6880
                hide_name = True
                size = 120, 20
            ]

            tag From11 {
                value = "Ic_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8712
                hide_name = True
                size = 60, 20
            ]

            tag From78 {
                value = "vc_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7000
                hide_name = True
                size = 60, 20
            ]

            tag Goto32 {
                value = "FRT inv enable"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8904, 7576
                hide_name = True
                size = 104, 20
            ]

            tag From79 {
                value = "va_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 6952
                hide_name = True
                size = 60, 20
            ]

            tag From49 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 5776, 7512
                hide_name = True
                size = 60, 20
            ]

            tag From18 {
                value = "vg_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8456, 8464
                hide_name = True
                size = 60, 20
            ]

            tag From42 {
                value = "Vdc_1"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7776, 7640
                hide_name = True
                size = 60, 20
            ]

            tag Goto11 {
                value = "vc_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8920, 8040
                hide_name = True
                size = 60, 20
            ]

            tag From47 {
                value = "vg_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10008, 9320
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From44 {
                value = "precharge_contactor"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9816, 7856
                hide_name = True
                size = 138, 20
            ]

            tag From53 {
                value = "enable-inv"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 5784, 7536
                rotation = down
                hide_name = True
                scale = -1, 1
                size = 96, 20
            ]

            tag "to Controller10" {
                value = "Q"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8816
                hide_name = True
                size = 60, 20
            ]

            tag From16 {
                value = "vc_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8840
                hide_name = True
                size = 60, 20
            ]

            tag From36 {
                value = "vg_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8296, 8616
                hide_name = True
                size = 60, 20
            ]

            tag From37 {
                value = "vg_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8296, 8648
                hide_name = True
                size = 60, 20
            ]

            tag From46 {
                value = "vg_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10008, 9344
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From41 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7776, 7608
                hide_name = True
                size = 60, 20
            ]

            tag From38 {
                value = "vg_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8296, 8584
                hide_name = True
                size = 60, 20
            ]

            tag From72 {
                value = "operating"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6576, 6856
                hide_name = True
                size = 138, 20
            ]

            tag Goto20 {
                value = "precharge_contactor"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9184, 7456
                hide_name = True
                size = 143, 20
            ]

            tag "to Controller15" {
                value = "pf"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8880
                hide_name = True
                size = 60, 20
            ]

            tag From59 {
                value = "vpb_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8504, 7376
                hide_name = True
                size = 60, 20
            ]

            tag From26 {
                value = "f"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6960, 7416
                hide_name = True
                size = 60, 20
            ]

            tag From13 {
                value = "Ic_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8760
                hide_name = True
                size = 60, 20
            ]

            tag From55 {
                value = "ramping"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6576, 7376
                hide_name = True
                size = 97, 20
            ]

            tag "to Controller5" {
                value = "vp_be"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8728, 8576
                hide_name = True
                size = 60, 20
            ]

            tag From57 {
                value = "vp_al"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6544, 7576
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller12" {
                value = "ia_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8912
                hide_name = True
                size = 60, 20
            ]

            tag From12 {
                value = "Ic_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8736
                hide_name = True
                size = 60, 20
            ]

            tag From6 {
                value = "Ig_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10328, 8992
                hide_name = True
                size = 60, 20
            ]

            tag From83 {
                value = "ib_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7048
                hide_name = True
                size = 60, 20
            ]

            tag From82 {
                value = "ia_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7024
                hide_name = True
                size = 60, 20
            ]

            tag From61 {
                value = "vp_be"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6544, 7608
                hide_name = True
                size = 60, 20
            ]

            tag Goto8 {
                value = "Ic_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8624, 8144
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller11" {
                value = "ib_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8944
                hide_name = True
                size = 60, 20
            ]

            tag From43 {
                value = "contactor"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9824, 7904
                hide_name = True
                size = 105, 20
            ]

            tag From63 {
                value = "u_be"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9128, 9400
                hide_name = True
                size = 60, 20
            ]

            tag From64 {
                value = "IN_pfref"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6168, 7584
                hide_name = True
                size = 60, 20
            ]

            tag From5 {
                value = "Ig_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10328, 8928
                hide_name = True
                size = 60, 20
            ]

            tag From45 {
                value = "vg_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10008, 9296
                hide_name = True
                scale = -1, 1
                size = 60, 20
            ]

            tag From84 {
                value = "Q"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7144
                hide_name = True
                size = 60, 20
            ]

            tag From28 {
                value = "states"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6936, 7336
                hide_name = True
                size = 97, 20
            ]

            tag From65 {
                value = "IN_qsign"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6168, 7608
                hide_name = True
                size = 60, 20
            ]

            tag From58 {
                value = "vpa_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8504, 7352
                hide_name = True
                size = 60, 20
            ]

            tag Goto27 {
                value = "IN_prioritytype"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6304, 6784
                hide_name = True
                size = 98, 20
            ]

            tag "to Controller2" {
                value = "vpb_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8728, 8624
                hide_name = True
                size = 60, 20
            ]

            tag From9 {
                value = "Ig_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8616
                hide_name = True
                size = 60, 20
            ]

            tag From4 {
                value = "Ig_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10328, 8864
                hide_name = True
                size = 60, 20
            ]

            tag Goto18 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7856, 8056
                hide_name = True
                size = 60, 20
            ]

            tag From88 {
                value = "f"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7096
                hide_name = True
                size = 60, 20
            ]

            tag From87 {
                value = "pf"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7192
                hide_name = True
                size = 60, 20
            ]

            tag From19 {
                value = "vg_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8456, 8440
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller14" {
                value = "S"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8848
                hide_name = True
                size = 60, 20
            ]

            tag From66 {
                value = "IN_enable"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9072, 7576
                hide_name = True
                size = 60, 20
            ]

            tag Goto5 {
                value = "vg_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10472, 8312
                hide_name = True
                size = 60, 20
            ]

            tag Goto26 {
                value = "IN_enable"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6296, 6760
                hide_name = True
                size = 77, 20
            ]

            tag From81 {
                value = "ic_rms"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7072
                hide_name = True
                size = 60, 20
            ]

            tag From67 {
                value = "IN_prioritytype"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6576, 7328
                hide_name = True
                size = 93, 20
            ]

            tag Goto25 {
                value = "u_be"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7384, 7528
                hide_name = True
                size = 60, 20
            ]

            tag From17 {
                value = "vg_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8456, 8416
                hide_name = True
                size = 60, 20
            ]

            tag Goto30 {
                value = "operating"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9528, 7576
                hide_name = True
                size = 104, 20
            ]

            tag From70 {
                value = "precharge_contactor"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6576, 6808
                hide_name = True
                size = 138, 20
            ]

            tag "to Controller13" {
                value = "ic_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10664, 8976
                hide_name = True
                size = 60, 20
            ]

            tag Goto13 {
                value = "vc_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9024, 8232
                hide_name = True
                size = 60, 20
            ]

            tag Goto24 {
                value = "u_al"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7384, 7496
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller3" {
                value = "vpc_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8728, 8648
                hide_name = True
                size = 60, 20
            ]

            tag Goto3 {
                value = "Ig_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9672, 8152
                hide_name = True
                size = 60, 20
            ]

            tag From86 {
                value = "S"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 7168
                hide_name = True
                size = 60, 20
            ]

            tag From40 {
                value = "f"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8504, 7552
                hide_name = True
                size = 60, 20
            ]

            tag From39 {
                value = "Ig_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8640
                hide_name = True
                size = 60, 20
            ]

            tag Goto7 {
                value = "Ic_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8624, 7944
                hide_name = True
                size = 60, 20
            ]

            tag "to Controller1" {
                value = "vpa_rms"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8728, 8600
                hide_name = True
                size = 60, 20
            ]

            tag Goto17 {
                value = "enable-inv"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9528, 7552
                hide_name = True
                size = 104, 20
            ]

            tag "to current controller" {
                value = "states"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9744, 9072
                size = 60, 20
            ]

            tag From68 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6536, 6760
                hide_name = True
                size = 60, 20
            ]

            tag From7 {
                value = "Ic_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7736, 7824
                hide_name = True
                size = 60, 20
            ]

            tag Goto2 {
                value = "Ig_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9672, 8056
                hide_name = True
                size = 60, 20
            ]

            tag Goto4 {
                value = "vg_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10472, 8264
                hide_name = True
                size = 60, 20
            ]

            tag From10 {
                value = "Ig_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9024, 8592
                hide_name = True
                size = 60, 20
            ]

            tag From1 {
                value = "vg_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10328, 8672
                hide_name = True
                size = 60, 20
            ]

            tag From30 {
                value = "enable-inv"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8112, 7888
                hide_name = True
                size = 96, 20
            ]

            tag From2 {
                value = "vg_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10328, 8736
                hide_name = True
                size = 60, 20
            ]

            tag Goto28 {
                value = "IN_pfref"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6296, 6808
                hide_name = True
                size = 79, 20
            ]

            tag Goto1 {
                value = "Ig_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9672, 7960
                hide_name = True
                size = 60, 20
            ]

            tag Goto21 {
                value = "contactor"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9184, 7480
                hide_name = True
                size = 143, 20
            ]

            tag Goto29 {
                value = "IN_qsign"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6296, 6832
                hide_name = True
                size = 83, 20
            ]

            tag From54 {
                value = "enable-inv"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 5888, 7336
                hide_name = True
                size = 96, 20
            ]

            junction Junction8 pe
            [
                position = 9128, 8320
            ]

            junction Junction27 pe
            [
                position = 9064, 8320
            ]

            junction Junction28 pe
            [
                position = 8952, 8320
            ]

            junction Junction29 pe
            [
                position = 8896, 8320
            ]

            junction Junction37 pe
            [
                position = 10304, 8424
            ]

            junction Junction157 pe
            [
                position = 8952, 8184
            ]

            junction Junction158 pe
            [
                position = 8896, 8088
            ]

            junction Junction159 pe
            [
                position = 8848, 7992
            ]

            junction Junction160 pe
            [
                position = 8032, 8088
            ]

            junction Junction164 pe
            [
                position = 7880, 8184
            ]

            junction Junction169 pe
            [
                position = 7944, 8088
            ]

            junction Junction170 pe
            [
                position = 7944, 8088
            ]

            junction Junction171 pe
            [
                position = 7944, 8184
            ]

            junction Junction289 sp
            [
                position = 9928, 7856
            ]

            junction Junction290 sp
            [
                position = 9944, 7904
            ]

            junction Junction293 sp
            [
                position = 9456, 9136
            ]

            junction Junction294 sp
            [
                position = 9456, 9008
            ]

            junction Junction321 sp
            [
                position = 6240, 7512
            ]

            junction Junction322 sp
            [
                position = 7328, 7512
            ]

            junction Junction323 sp
            [
                position = 7328, 7544
            ]

            junction Junction326 sp
            [
                position = 6280, 7512
            ]

            junction Junction327 sp
            [
                position = 6392, 7544
            ]

            junction Junction329 sp
            [
                position = 6936, 7608
            ]

            junction Junction334 pe
            [
                position = 10352, 8424
            ]

            junction Junction336 sp
            [
                position = 8816, 7400
            ]

            junction Junction337 sp
            [
                position = 8816, 7576
            ]

            junction Junction339 pe
            [
                position = 7776, 8184
            ]

            junction Junction340 pe
            [
                position = 7944, 7992
            ]

            junction Junction341 pe
            [
                position = 7776, 7992
            ]

            junction Junction342 pe
            [
                position = 10592, 7992
            ]

            junction Junction343 pe
            [
                position = 10624, 8088
            ]

            junction Junction344 pe
            [
                position = 10656, 8184
            ]

            junction Junction345 pe
            [
                position = 10624, 8424
            ]

            junction Junction346 sp
            [
                position = 6936, 7512
            ]

            junction Junction347 pe
            [
                position = 9864, 7992
            ]

            junction Junction348 pe
            [
                position = 9840, 8088
            ]

            junction Junction349 pe
            [
                position = 9816, 8184
            ]

            junction Junction350 pe
            [
                position = 10256, 7992
            ]

            junction Junction351 pe
            [
                position = 10304, 8088
            ]

            junction Junction352 pe
            [
                position = 10352, 8184
            ]

            junction Junction353 pe
            [
                position = 10056, 7992
            ]

            junction Junction354 pe
            [
                position = 10080, 8088
            ]

            junction Junction355 pe
            [
                position = 10104, 8184
            ]

            junction Junction356 pe
            [
                position = 9064, 7992
            ]

            junction Junction357 pe
            [
                position = 9128, 8088
            ]

            junction Junction358 pe
            [
                position = 9192, 8184
            ]

            junction Junction359 sp
            [
                position = 6064, 7512
            ]

            junction Junction360 sp
            [
                position = 5888, 7432
            ]

            junction Junction361 pe
            [
                position = 8032, 8088
            ]

            junction Junction362 pe
            [
                position = 8032, 7992
            ]

            junction Junction363 pe
            [
                position = 8032, 8184
            ]

            junction Junction364 pe
            [
                position = 8416, 8088
            ]

            junction Junction365 pe
            [
                position = 8416, 7992
            ]

            comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Protection, startup and shutdown</p></body></html> ENDCOMMENT 
            [
                position = 8984, 7360
            ]

            comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">When converter is off, controller drives the model so states are properly initialized when turning on.</p></body></html> ENDCOMMENT 
            [
                position = 9048, 9448
            ]

            comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">If neutral is not connected, resistive neutral provides it and measurements are as if we had used only line voltages</p></body></html> ENDCOMMENT 
            [
                position = 10232, 8472
            ]

            comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Only for SCADA measurements</p></body></html> ENDCOMMENT 
            [
                position = 10368, 9064
            ]

            connect B Junction343 as Connection2613
            connect "Bus Split1.out2" "State feedback Resonant Current Controller.ic_al" as Connection2013
            connect "Bus Split1.out5" "State feedback Resonant Current Controller.vc_be" as Connection2010
            connect "Bus Split1.out" "State feedback Resonant Current Controller.ig_al" as Connection2015
            connect "Bus Split1.out3" "State feedback Resonant Current Controller.ic_be" as Connection2012
            connect "Bus Split1.out1" "State feedback Resonant Current Controller.ig_be" as Connection2014
            connect "Bus Split1.out4" "State feedback Resonant Current Controller.vc_al" as Connection2011
            connect C3.n_node Junction27 as Connection145
            connect C4.p_node Junction357 as Connection2671
            connect C4.n_node Junction8 as Connection34
            connect C5.p_node Junction358 as Connection2674
            connect C7.p_node Junction160 as Connection884
            connect "Constant power factor.P" Junction321 as Connection2445
            connect "Constant power factor.Q" Junction327 as Connection2474
            connect Constant1.out "alfa-beta-gamma to abc1.y" as Connection2228
            connect "Core Coupling 2.c_in" Junction157 as Connection864
            connect "Core Coupling 2.b_in" Junction158 as Connection867
            connect "Core Coupling 2.a_in" Junction159 as Connection870
            connect "Core Coupling 2.a_out" L1.n_node as Connection2216
            connect "Core Coupling 2.b_out" L2.n_node as Connection2217
            connect "Core Coupling 2.c_out" L3.n_node as Connection2218
            connect "DC Voltage Controller.P" Junction359 as Connection2678
            connect "DC Voltage Controller.Vdc ref" Junction360 as Connection2682
            connect DCneg Junction339 as Connection2597
            connect DCpos Junction341 as Connection2603
            connect "Frequency ride-through.Enable inverter" Junction337 as Connection2551
            connect From1 "PCC Measurements.va" as Connection2566
            connect From10 "abc to alfa-beta-gamma1.a" as Connection2242
            connect From12 "abc to alfa-beta-gamma2.b" as Connection2246
            connect From13 "abc to alfa-beta-gamma2.c" as Connection2247
            connect From16 "abc to alfa-beta-gamma3.a" as Connection2252
            connect From17 PLL.Va as Connection2560
            connect From18 PLL.Vc as Connection2562
            connect From19 PLL.Vb as Connection2563
            connect From26 "State feedback Resonant Current Controller.f" as Connection2484
            connect From27 "Fundamental positive sequence estimator.f" as Connection1861
            connect From28 "Bus Split1.in" as Connection2460
            connect From3 "PCC Measurements.vc" as Connection2580
            connect From31 Sign2.in as Connection2111
            connect From36 "Fundamental positive sequence estimator.vb" as Connection1860
            connect From37 "Fundamental positive sequence estimator.vc" as Connection2052
            connect From38 "Fundamental positive sequence estimator.va" as Connection1859
            connect From39 "abc to alfa-beta-gamma1.c" as Connection2244
            connect From4 "PCC Measurements.ia" as Connection2579
            connect From40 "Frequency ride-through.value" as Connection2483
            connect From43 Junction290 as Connection1942
            connect From44 Junction289 as Connection1939
            connect From45 "abc to alfa-beta-gamma4.a" as Connection2259
            connect From48 "Signal switch1.in2" as Connection2158
            connect From49 "DC Voltage Controller.Vdc" as Connection2281
            connect From5 "PCC Measurements.ib" as Connection2572
            connect From53 "DC Voltage Controller.Enable" as Connection2283
            connect From54 MPPT.Enable as Connection2285
            connect From55 Product1.in as Connection2428
            connect From56 Product1.in1 as Connection2429
            connect From57 "Open-loop Power Controller.v_al" as Connection2447
            connect From58 "Voltage ride-through.va rms" as Connection2437
            connect From59 "Voltage ride-through.vb rms" as Connection2436
            connect From6 "PCC Measurements.ic" as Connection2578
            connect From60 "Voltage ride-through.vc rms" as Connection2435
            connect From61 "Open-loop Power Controller.v_be" as Connection2448
            connect From62 "LCL filter model.u_alpha" as Connection2477
            connect From63 "LCL filter model.u_beta" as Connection2478
            connect From64 "Constant power factor.Pf ref (abs)" as Connection2525
            connect From65 "Constant power factor.Q sign" as Connection2526
            connect From66 "Logical operator2.in1" as Connection2527
            connect From67 "Open-loop Power Controller.Type" as Connection2528
            connect From68 "Bus Join1.in" as Connection2534
            connect From69 "Bus Join1.in1" as Connection2535
            connect From7 Sign3.in as Connection2113
            connect From70 "Bus Join1.in2" as Connection2536
            connect From71 "Bus Join1.in3" as Connection2537
            connect From72 "Bus Join1.in4" as Connection2539
            connect From75 "Bus Join1.in5" as Connection2554
            connect From76 "Bus Join1.in6" as Connection2555
            connect From77 "Bus Join1.in7" as Connection2556
            connect From78 "Bus Join1.in10" as Connection2559
            connect From79 "Bus Join1.in8" as Connection2557
            connect From8 Sign1.in as Connection2109
            connect From80 "Bus Join1.in9" as Connection2558
            connect From81 "Bus Join1.in13" as Connection2584
            connect From82 "Bus Join1.in11" as Connection2582
            connect From83 "Bus Join1.in12" as Connection2583
            connect From84 "Bus Join1.in16" as Connection2586
            connect From85 "Bus Join1.in15" as Connection2585
            connect From86 "Bus Join1.in17" as Connection2587
            connect From87 "Bus Join1.in18" as Connection2588
            connect From88 "Bus Join1.in14" as Connection2589
            connect From9 "abc to alfa-beta-gamma1.b" as Connection2243
            connect Goto14 PLL.f as Connection2561
            connect Goto17 "Startup and Shutdown Ramping.switching enable" as Connection2060
            connect Goto18 V_dc.out as Connection1819
            connect Goto19 V_dc_1.out as Connection1820
            connect Goto22 "Startup and Shutdown Ramping.ref control" as Connection2426
            connect Goto23 "Voltage ride-through.Enable references" as Connection2427
            connect Goto24 Junction322 as Connection2453
            connect Goto25 Junction323 as Connection2464
            connect Goto30 "Startup and Shutdown Ramping.operating" as Connection2538
            connect Goto31 Junction336 as Connection2550
            connect Goto32 Junction337 as Connection2553
            connect "Grid connection sequencing.Pre-charge contactor" Goto20 as Connection1937
            connect "Grid connection sequencing.Main contactor" Goto21 as Connection1938
            connect "Grid connection sequencing.RT Enable" "Logical operator1.out" as Connection1887
            connect "Grid connection sequencing.Inverter enable" "Logical operator2.in" as Connection2166
            connect Ic_a.out Goto7 as Connection1766
            connect Ic_a.n_node L1.p_node as Connection72
            connect Ic_b.out Goto9 as Connection1767
            connect Ic_b.n_node L2.p_node as Connection73
            connect Ic_c.out Goto8 as Connection1768
            connect Ic_c.n_node L3.p_node as Connection74
            connect Ig_a.out Goto1 as Connection1772
            connect Ig_a.n_node Junction347 as Connection2640
            connect Ig_b.out Goto2 as Connection1773
            connect Ig_b.n_node Junction348 as Connection2643
            connect Ig_c.out Goto3 as Connection1774
            connect Ig_c.n_node Junction349 as Connection2646
            connect Junction159 Junction356 as Connection2668
            connect Junction160 C6.n_node as Connection883
            connect Junction169 V_dc_1.p_node as Connection2070
            connect Junction170 Junction169 as Connection921
            connect Junction171 Junction164 as Connection924
            connect Junction27 Junction8 as Connection146
            connect Junction28 Junction27 as Connection149
            connect Junction289 S2.ctrl_in as Connection1940
            connect Junction29 Junction28 as Connection152
            connect Junction290 S1.ctrl_in as Connection1943
            connect Junction293 "LCL filter model.states" as Connection2174
            connect Junction294 "bus join.out" as Connection2177
            connect Junction322 "alfa-beta-gamma to abc1.al" as Connection2458
            connect Junction323 "alfa-beta-gamma to abc1.be" as Connection2463
            connect Junction326 Junction321 as Connection2472
            connect Junction327 "Open-loop Power Controller.Qref" as Connection2475
            connect Junction329 "State feedback Resonant Current Controller.ig_be_ref" as Connection2492
            connect Junction334 Junction37 as Connection2516
            connect Junction336 "Voltage ride-through.Enable inverter" as Connection2549
            connect Junction337 "Logical operator1.in1" as Connection2552
            connect Junction339 Junction164 as Connection2596
            connect Junction341 Junction340 as Connection2604
            connect Junction342 A as Connection2611
            connect Junction344 C as Connection2617
            connect Junction345 Junction334 as Connection2620
            connect Junction346 "Open-loop Power Controller.ref_al" as Connection2624
            connect Junction347 S1.a_in as Connection2639
            connect Junction348 R2.p_node as Connection2642
            connect Junction349 R3.p_node as Connection2645
            connect Junction350 Junction342 as Connection2648
            connect Junction351 Junction343 as Connection2651
            connect Junction352 Junction344 as Connection2654
            connect Junction353 Junction350 as Connection2657
            connect Junction354 Junction351 as Connection2660
            connect Junction355 Junction352 as Connection2663
            connect Junction356 C3.p_node as Connection2669
            connect Junction357 Junction158 as Connection2672
            connect Junction358 Junction157 as Connection2675
            connect Junction359 Junction321 as Connection2679
            connect Junction360 "Probe Vdcref.in" as Connection2683
            connect Junction8 C5.n_node as Connection33
            connect L4.n_node Ig_a.p_node as Connection2635
            connect L4.p_node Junction356 as Connection2670
            connect L5.n_node Ig_b.p_node as Connection2636
            connect L5.p_node Junction357 as Connection2673
            connect L6.n_node Ig_c.p_node as Connection2637
            connect L6.p_node Junction358 as Connection2676
            connect "Logical operator1.in" Junction336 as Connection2548
            connect "Logical operator2.out" "Startup and Shutdown Ramping.enable" as Connection2167
            connect "MPPT.PV Power" Junction359 as Connection2680
            connect MPPT.Vdc Junction360 as Connection2684
            connect "Modulation and DC balancing.Vdc" From41 as Connection2123
            connect "Modulation and DC balancing.Vdc_half" From42 as Connection2124
            connect "Modulation and DC balancing.sign_ic_a" Sign1.out as Connection2125
            connect "Modulation and DC balancing.sign_ic_b" Sign2.out as Connection2126
            connect "Modulation and DC balancing.sign_ic_c" Sign3.out as Connection2127
            connect N Junction345 as Connection2619
            connect "Open-loop Power Controller.Pref" Junction326 as Connection2471
            connect "Open-loop Power Controller.ref_be" Junction329 as Connection2493
            connect "PCC Measurements.vb" From2 as Connection2581
            connect "Probe Pref.in" Junction326 as Connection2473
            connect "Probe Qref.in" Junction327 as Connection2476
            connect "Probe iref_al.in" Junction346 as Connection2625
            connect "Probe iref_be.in" Junction329 as Connection2491
            connect Product1.out "Open-loop Power Controller.control" as Connection2485
            connect R1.p_node Junction347 as Connection2638
            connect R1.n_node S2.a_in as Connection749
            connect R2.n_node S2.b_in as Connection750
            connect R3.n_node S2.c_in as Connection751
            connect R4.n_node Junction170 as Connection920
            connect R4.p_node Junction340 as Connection2600
            connect R5.p_node Junction170 as Connection922
            connect R5.n_node Junction171 as Connection925
            connect "Resistive Neutral1.A" Junction342 as Connection2612
            connect "Resistive Neutral1.B" Junction343 as Connection2615
            connect "Resistive Neutral1.C" Junction344 as Connection2618
            connect "Resistive Neutral1.N" Junction345 as Connection2621
            connect S1.b_in Junction348 as Connection2641
            connect S1.c_in Junction349 as Connection2644
            connect S1.a_out Junction353 as Connection2656
            connect S1.b_out Junction354 as Connection2659
            connect S1.c_out Junction355 as Connection2662
            connect S2.a_out Junction353 as Connection2658
            connect S2.b_out Junction354 as Connection2661
            connect S2.c_out Junction355 as Connection2664
            connect "Signal switch1.in1" Junction293 as Connection2173
            connect "Signal switch1.in" Junction294 as Connection2176
            connect "State feedback Resonant Current Controller.u_al" Junction322 as Connection2451
            connect "State feedback Resonant Current Controller.u_be" Junction323 as Connection2462
            connect "State feedback Resonant Current Controller.ig_al_ref" Junction346 as Connection2623
            connect Termination10.in "Frequency ride-through.Enable references" as Connection2266
            connect Termination11.in "Open-loop Power Controller.Plim" as Connection2494
            connect Termination12.in "Open-loop Power Controller.Qlim" as Connection2495
            connect Termination6.in "abc to alfa-beta-gamma1.y" as Connection2255
            connect Termination7.in "abc to alfa-beta-gamma2.y" as Connection2256
            connect Termination8.in "abc to alfa-beta-gamma3.y" as Connection2257
            connect Termination9.in "abc to alfa-beta-gamma4.y" as Connection2258
            connect V_dc.n_node Junction339 as Connection2595
            connect V_dc.p_node Junction341 as Connection2605
            connect V_dc_1.n_node Junction164 as Connection896
            connect "abc to alfa-beta-gamma1.al" "bus join.in" as Connection2240
            connect "abc to alfa-beta-gamma1.be" "bus join.in1" as Connection2241
            connect "abc to alfa-beta-gamma2.a" From11 as Connection2245
            connect "abc to alfa-beta-gamma2.be" "bus join.in3" as Connection2249
            connect "abc to alfa-beta-gamma2.al" "bus join.in2" as Connection2248
            connect "abc to alfa-beta-gamma3.b" From14 as Connection2253
            connect "abc to alfa-beta-gamma3.c" From15 as Connection2254
            connect "abc to alfa-beta-gamma3.be" "bus join.in5" as Connection2251
            connect "abc to alfa-beta-gamma3.al" "bus join.in4" as Connection2250
            connect "abc to alfa-beta-gamma4.c" From46 as Connection2261
            connect "abc to alfa-beta-gamma4.b" From47 as Connection2260
            connect "abc to alfa-beta-gamma4.be" "LCL filter model.vg_beta" as Connection2263
            connect "abc to alfa-beta-gamma4.al" "LCL filter model.vg_alpha" as Connection2262
            connect "alfa-beta-gamma to abc1.c" "Modulation and DC balancing.u_c" as Connection2231
            connect "alfa-beta-gamma to abc1.b" "Modulation and DC balancing.u_b" as Connection2230
            connect "alfa-beta-gamma to abc1.a" "Modulation and DC balancing.u_a" as Connection2229
            connect contactor.in Junction290 as Connection1944
            connect "model states.in" Junction293 as Connection2175
            connect precharge_contactor.in Junction289 as Connection1941
            connect "real states.in" Junction294 as Connection2178
            connect "to Controller1" "Fundamental positive sequence estimator.vpa_rms" as Connection2430
            connect "to Controller10" "PCC Measurements.Q" as Connection2575
            connect "to Controller11" "PCC Measurements.ib_rms" as Connection2573
            connect "to Controller12" "PCC Measurements.ia_rms" as Connection2574
            connect "to Controller13" "PCC Measurements.ic_rms" as Connection2571
            connect "to Controller14" "PCC Measurements.S" as Connection2577
            connect "to Controller15" "PCC Measurements.pf" as Connection2576
            connect "to Controller2" "Fundamental positive sequence estimator.vpb_rms" as Connection2431
            connect "to Controller3" "Fundamental positive sequence estimator.vpc_rms" as Connection2432
            connect "to Controller4" "Fundamental positive sequence estimator.vp_al" as Connection2433
            connect "to Controller5" "Fundamental positive sequence estimator.vp_be" as Connection2434
            connect "to Controller6" "PCC Measurements.va_rms" as Connection2568
            connect "to Controller7" "PCC Measurements.vc_rms" as Connection2564
            connect "to Controller8" "PCC Measurements.vb_rms" as Connection2569
            connect "to Controller9" "PCC Measurements.P" as Connection2570
            connect "to current controller" "Signal switch1.out" as Connection2155
            connect vc_a.out Goto11 as Connection1769
            connect vc_a.p_node Junction159 as Connection868
            connect vc_a.n_node Junction29 as Connection153
            connect vc_b.out Goto12 as Connection1770
            connect vc_b.p_node Junction158 as Connection865
            connect vc_b.n_node Junction29 as Connection151
            connect vc_c.out Goto13 as Connection1771
            connect vc_c.p_node Junction157 as Connection862
            connect vc_c.n_node Junction28 as Connection148
            connect vg_a.out Goto4 as Connection1775
            connect vg_a.p_node Junction350 as Connection2647
            connect vg_a.n_node Junction37 as Connection962
            connect vg_b.out Goto5 as Connection1776
            connect vg_b.p_node Junction351 as Connection2650
            connect vg_b.n_node Junction37 as Connection182
            connect vg_c.out Goto6 as Connection1777
            connect vg_c.n_node Junction334 as Connection2515
            connect vg_c.p_node Junction352 as Connection2653
            connect Junction169 Junction361 as Connection2690
            [
                position = 0, 0
                breakpoints = 7944, 8088
            ]
            connect Junction361 Junction160 as Connection2691
            [
                position = 0, 0
                breakpoints = 8032, 8088
            ]
            connect Inverter.DCn Junction361 as Connection2692
            connect C6.p_node Junction362 as Connection2693
            connect Junction362 Junction340 as Connection2694
            [
                position = 0, 0
                breakpoints = 8032, 7992
            ]
            connect Inverter.DC+ Junction362 as Connection2695
            connect C7.n_node Junction363 as Connection2696
            connect Junction363 Junction171 as Connection2697
            [
                position = 0, 0
                breakpoints = 8032, 8184
            ]
            connect Inverter.DC- Junction363 as Connection2698
            connect Ic_b.p_node Junction364 as Connection2699
            connect Junction364 Vab.n_node as Connection2700
            [
                position = 0, 0
                breakpoints = 8416, 8088
            ]
            connect Inverter.B Junction364 as Connection2701
            connect Vab.p_node Junction365 as Connection2702
            connect Junction365 Ic_a.p_node as Connection2703
            [
                position = 0, 0
                breakpoints = 8416, 7992
            ]
            connect Inverter.A Junction365 as Connection2704
            connect Inverter.C Ic_c.p_node as Connection2705
            connect From30 Inverter.En as Connection2706
            connect "Bus Join2.in" "Modulation and DC balancing.a high" as Connection2707
            connect "Bus Join2.in1" "Modulation and DC balancing.a low" as Connection2708
            connect "Modulation and DC balancing.b high" "Bus Join3.in" as Connection2709
            connect "Bus Join3.in1" "Modulation and DC balancing.b low" as Connection2710
            connect "Modulation and DC balancing.c high" "Bus Join4.in" as Connection2711
            connect "Bus Join4.in1" "Modulation and DC balancing.c low" as Connection2712
            connect Inverter.InA "Bus Join2.out" as Connection2713
            connect "Bus Join3.out" Inverter.InB as Connection2714
            connect Inverter.InC "Bus Join4.out" as Connection2715
            connect "NPC enable.out" Goto26 as Connection2716
            connect Priority.out Goto27 as Connection2717
            connect "pf ref.out" Goto28 as Connection2718
            connect Goto29 Qsign.out as Connection2719
            connect "Bus Split2.out5" FRT_inv_enable.in as Connection2606
            connect "Bus Split2.out11" Ia_rms.in as Connection2607
            connect "Bus Split2.out12" Ib_rms.in as Connection2608
            connect "Bus Split2.out13" Ic_rms.in as Connection2609
            connect "Bus Split2.out15" P.in as Connection2610
            connect "Bus Split2.out16" Q.in as Connection2720
            connect "Bus Split2.out17" S.in as Connection2721
            connect "Bus Split2.out6" VRT_inv_enable.in as Connection2722
            connect "Bus Split2.out7" VRT_ref_enable.in as Connection2614
            connect "Bus Split2.out8" Va_rms.in as Connection2723
            connect "Bus Split2.out9" Vb_rms.in as Connection2616
            connect "Bus Split2.out10" Vc_rms.in as Connection2724
            connect "Bus Split2.out1" Vdc_half.in as Connection2725
            connect "Bus Split2.out" Vdc_total.in as Connection2726
            connect "Bus Split2.out14" f.in as Connection2727
            connect "Bus Split2.out3" main_contactor.in as Connection2728
            connect "Bus Split2.out4" operating.in as Connection2622
            connect pf.in "Bus Split2.out18" as Connection2729
            connect precharging_contactor.in "Bus Split2.out2" as Connection2730
            connect "Bus Join1.out" "Bus Split2.in" as Connection2731

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Low voltage 3-level NPC Solar Inverter</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Rated DC Voltage: 1000 V</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Rated AC Power: 1 MVA @ 480 Vrms L-L</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Inputs: 0-Enable; 1-Saturation Priority; 2-Power factor reference (absolute); 3-Reactive power direction</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Outputs: 0-DC voltage; 1-DC midpoint voltage; 2-Precharging contactor; 3-main contactor; 4-operating; 5-frequency ride through inverter enable; 6-voltage ride through inverter enable; 7-voltage ride through references enable; 8-Va rms; 9- Vb rms; 10-Vc rms; 11- Ia rms; 12-Ib rms; 13-Ic rms; 14-Frequency; 15-Active Power; 16-Reactive power; 17-Apparent power; 18-Power factor</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">For more details on inputs and outpus, check component help page.</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Developed in partnership with Federal University of Santa Maria, Brazil.</span></p></body></html>"
                help_file = "npc_pv_inverter.html"

                fnom {
                    label = "Frequency"
                    widget = edit
                    type = generic
                    default_value = "60"
                    unit = "Hz"
                }

                vnom {
                    label = "Voltage"
                    widget = edit
                    type = generic
                    default_value = "277"
                    unit = "Vrms L-N"
                }

                CODE define_icon
                    mdl.set_component_icon_image(item_handle, "converter_cabinet.svg")
                ENDCODE

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 4496, 4392
            size = 288, 239
        ]

        comment Comment1 START Consider using the Category component to better organize your library items in the tree. ENDCOMMENT 
        [
            position = 4192, 4192
        ]
    }

    default {
        gen_PQ_transform {
            filter_order = "first order"
            filter_cutoff_Hz = "30"
            initial_filter_input = "0"
            initial_filter_output = "0"
            enable_inst_ports = "True"
            enable_zero_ports = "False"
            execution_rate = "inherit"
        }

        gen_bus_join {
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_bus_split {
            outputs = "2"
            execution_rate = "inherit"
        }

        gen_c_function {
            input_terminals = "real in;"
            input_terminals_show_labels = "False;"
            input_terminals_feedthrough = "True;"
            input_terminals_dimensions = "inherit;"
            output_terminals = "real out;"
            output_terminals_show_labels = "False;"
            output_terminals_feedthrough = "True;"
            output_terminals_dimensions = "inherit;"
            output_fnc = ""
            update_fnc = ""
            init_fnc = ""
            global_variables = ""
            parameters = ""
            execution_rate = "inherit"
        }

        gen_delay {
            delay_type = "Fixed delay"
            del_length = "2"
            max_delay_length = "20"
            init_value = "0"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        gen_digital_probe {
            override_signal_name = "False"
            signal_name = ""
            streaming_en = "False"
            addr = "0"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        gen_gain {
            gain = "1"
            multiplication = "Element-wise(K.*u)"
            _tunable = "False"
            execution_rate = "inherit"
        }

        gen_limiter {
            upper_limit = "[\'inf\']"
            lower_limit = "[\'-inf\']"
            execution_rate = "inherit"
        }

        gen_logic_op {
            operator = "AND"
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_minmax {
            operation = "min"
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_probe {
            addr = "0"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "generic"
            streaming_en = "False"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        gen_product {
            signs = "2"
            execution_rate = "inherit"
        }

        gen_rms_value {
            op_mode = "PLL based"
            frequency = "50"
            period_timeout = "0.5"
            period_deadband = "0"
            filter_en = "False"
            lpf_cutoff = "500"
            frequency_src = "Internal"
            execution_rate = "inherit"
        }

        gen_sign {
            execution_rate = "inherit"
        }

        gen_sum {
            signs = "2"
            execution_rate = "inherit"
        }

        gen_terminator {
            execution_rate = "inherit"
        }

        pas_capacitor {
            capacitance = "1e-6"
            initial_voltage = "0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        pas_inductor {
            inductance = "1e-3"
            initial_current = "0.0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        pas_resistor {
            resistance = "1"
            param_set = ""
        }

        src_constant {
            value = "1"
            signal_type = "real"
            execution_rate = "100e-6"
            _tunable = "False"
        }

        src_scada_input {
            addr = "0"
            format = "real"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "real"
            min = "-1e6"
            max = "1e6"
            def_value = "0"
            unit = " "
            execution_rate = "100e-6"
        }

        sys_signal_switch {
            criterion = "ctrl >= threshold"
            threshold = "0"
            execution_rate = "inherit"
        }

        "core/Current Measurement" {
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "core/DC Energy Calculation" {
            C_dc = "0"
        }

        "core/Generic UL 1741 ride-through" {
            Nom = "0"
            L1val = "0"
            L1duration = "0"
            L1cessation = "True"
            L2val = "0"
            L2duration = "0"
            L2cessation = "True"
            L3val = "0"
            L3duration = "0"
            L3cessation = "True"
            H2val = "0"
            H2duration = "0"
            H2cessation = "True"
            H1val = "0"
            H1duration = "0"
            H1cessation = "True"
        }

        "core/Open-loop Power Controller" {
            imax = "1000"
            ratemax = "50000"
        }

        "core/Rate Transition" {
            init_value = "0.0"
            execution_rate = "100e-6"
        }

        "core/Resistive Neutral" {
            R = "1e6"
        }

        "core/Three Phase Core Coupling" {
            snb_type_i = "none"
            R1 = "100e3"
            C1 = "1e-06"
            C2 = "1e-06"
            fixed_snb_i = "false"
            snb_type_u = "none"
            R2 = "0.1"
            L1 = "0.1"
            L2 = "0.1"
            fixed_snb_u = "false"
            cpl_connection = "star"
        }

        "core/Three Phase NPC Inverter" {
            ctrl_src = "Digital input per switch"
            op_mode = "Fixed carrier frequency"
            carrier_freq = "10000.0"
            carr_ph_offset = "0.0"
            d_time = "5e-6"
            ref_sig_min_max = "[-1.0, 1.0]"
            load_mode = "on min"
            execution_rate = "inherit"
            Sa_1 = "1"
            Sa_1_logic = "active high"
            Sa_2 = "2"
            Sa_2_logic = "active high"
            Sa_3 = "3"
            Sa_3_logic = "active high"
            Sa_4 = "4"
            Sa_4_logic = "active high"
            Sb_1 = "5"
            Sb_1_logic = "active high"
            Sb_2 = "6"
            Sb_2_logic = "active high"
            Sb_3 = "7"
            Sb_3_logic = "active high"
            Sb_4 = "8"
            Sb_4_logic = "active high"
            Sc_1 = "9"
            Sc_1_logic = "active high"
            Sc_2 = "10"
            Sc_2_logic = "active high"
            Sc_3 = "11"
            Sc_3_logic = "active high"
            Sc_4 = "12"
            Sc_4_logic = "active high"
            delay_enabled = "False"
            fixed_delay = "1e-6"
            var_delay_lut = "[-10.0, 1e-6, 10.0, 1e-6]"
            preview_var_delay = "Preview"
            losses_estimation = "False"
            losses_groups = "Group1"
            fvd_def_method_g1 = "Voltage and Resistance"
            fvd_def_method_g2 = "Voltage and Resistance"
            fvd_def_method_g3 = "Voltage and Resistance"
            Import_igbt_xml_g1 = "not selected"
            Import_diode_xml_g1 = "not selected"
            Import_igbt_xml_g2 = "not selected"
            Import_diode_xml_g2 = "not selected"
            Import_diode_xml_g3 = "not selected"
            Switch_type_g1 = "IGBT"
            Switch_type_g2 = "IGBT"
            Vce_g1 = "1.3"
            Rce_g1 = "0"
            Vd_g1 = "1.2"
            Rd_g1 = "0"
            i_sw_g1 = "[0.0, 6.0, 12.0, 18.0, 24.0]"
            v_sw_g1 = "[0.0, 600.0]"
            temp_sw_g1 = "[25.0, 50.0, 75.0, 100.0, 125.0]"
            vce_table_out_g1 = "[1.3, 1.3, 1.3, 1.3, 1.3]"
            vd_table_out_g1 = "[1.2, 1.2, 1.2, 1.2, 1.2]"
            et_on_table_out_g1 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*3.8e-3, 0.4*3.8e-3, 0.8*3.8e-3, 0.68*3.8e-3, 0.9*3.8e-3], [0.65*3.8e-3, 0.9*3.8e-3, 1.2*3.8e-3, 1.5*3.8e-3, 1.7*3.8e-3], [0.9*3.8e-3, 1.3*3.8e-3, 1.7*3.8e-3, 1.9*3.8e-3, 2.25*3.8e-3], [1.1*3.8e-3, 1.7*3.8e-3, 2.1*3.8e-3, 2.3*3.8e-3, 2.5*3.8e-3]]"
            et_off_table_out_g1 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.1e-3, 0.4*2.1e-3, 0.8*2.1e-3, 0.68*2.1e-3, 0.9*2.1e-3], [0.65*2.1e-3, 0.9*2.1e-3, 1.2*2.1e-3, 1.5*2.1e-3, 1.7*2.1e-3], [0.9*2.1e-3, 1.3*2.1e-3, 1.7*2.1e-3, 1.9*2.1e-3, 2.25*2.1e-3], [1.1*2.1e-3, 1.7*2.1e-3, 2.1*2.1e-3, 2.3*2.1e-3, 2.5*2.1e-3]]"
            ed_off_table_out_g1 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.2e-3, 0.4*2.2e-3, 0.8*2.2e-3, 0.68*2.2e-3, 0.9*2.2e-3], [0.65*2.2e-3, 0.9*2.2e-3, 1.2*2.2e-3, 1.5*2.2e-3, 1.7*2.2e-3], [0.9*2.2e-3, 1.3*2.2e-3, 1.7*2.2e-3, 1.9*2.2e-3, 2.25*2.2e-3], [1.1*2.2e-3, 1.7*2.2e-3, 2.1*2.2e-3, 2.3*2.2e-3, 2.5*2.2e-3]]"
            Vce_g2 = "1.3"
            Rce_g2 = "0"
            Vd_g2 = "1.2"
            Rd_g2 = "0"
            i_sw_g2 = "[0.0, 6.0, 12.0, 18.0, 24.0]"
            v_sw_g2 = "[0.0, 600.0]"
            temp_sw_g2 = "[25.0, 50.0, 75.0, 100.0, 125.0]"
            vce_table_out_g2 = "[1.3, 1.3, 1.3, 1.3, 1.3]"
            vd_table_out_g2 = "[1.2, 1.2, 1.2, 1.2, 1.2]"
            et_on_table_out_g2 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*3.8e-3, 0.4*3.8e-3, 0.8*3.8e-3, 0.68*3.8e-3, 0.9*3.8e-3], [0.65*3.8e-3, 0.9*3.8e-3, 1.2*3.8e-3, 1.5*3.8e-3, 1.7*3.8e-3], [0.9*3.8e-3, 1.3*3.8e-3, 1.7*3.8e-3, 1.9*3.8e-3, 2.25*3.8e-3], [1.1*3.8e-3, 1.7*3.8e-3, 2.1*3.8e-3, 2.3*3.8e-3, 2.5*3.8e-3]]"
            et_off_table_out_g2 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.1e-3, 0.4*2.1e-3, 0.8*2.1e-3, 0.68*2.1e-3, 0.9*2.1e-3], [0.65*2.1e-3, 0.9*2.1e-3, 1.2*2.1e-3, 1.5*2.1e-3, 1.7*2.1e-3], [0.9*2.1e-3, 1.3*2.1e-3, 1.7*2.1e-3, 1.9*2.1e-3, 2.25*2.1e-3], [1.1*2.1e-3, 1.7*2.1e-3, 2.1*2.1e-3, 2.3*2.1e-3, 2.5*2.1e-3]]"
            ed_off_table_out_g2 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.2e-3, 0.4*2.2e-3, 0.8*2.2e-3, 0.68*2.2e-3, 0.9*2.2e-3], [0.65*2.2e-3, 0.9*2.2e-3, 1.2*2.2e-3, 1.5*2.2e-3, 1.7*2.2e-3], [0.9*2.2e-3, 1.3*2.2e-3, 1.7*2.2e-3, 1.9*2.2e-3, 2.25*2.2e-3], [1.1*2.2e-3, 1.7*2.2e-3, 2.1*2.2e-3, 2.3*2.2e-3, 2.5*2.2e-3]]"
            Vd_g3 = "1.2"
            Rd_g3 = "0"
            i_sw_g3 = "[0.0, 6.0, 12.0, 18.0, 24.0]"
            v_sw_g3 = "[0.0, 600.0]"
            temp_sw_g3 = "[25.0, 50.0, 75.0, 100.0, 125.0]"
            vd_table_out_g3 = "[1.2, 1.2, 1.2, 1.2, 1.2]"
            ed_off_table_out_g3 = "[[0.0, 0.0275e-3, 0.15e-3, 0.275e-3, 0.3e-3], [0.35*2.2e-3, 0.4*2.2e-3, 0.8*2.2e-3, 0.68*2.2e-3, 0.9*2.2e-3], [0.65*2.2e-3, 0.9*2.2e-3, 1.2*2.2e-3, 1.5*2.2e-3, 1.7*2.2e-3], [0.9*2.2e-3, 1.3*2.2e-3, 1.7*2.2e-3, 1.9*2.2e-3, 2.25*2.2e-3], [1.1*2.2e-3, 1.7*2.2e-3, 2.1*2.2e-3, 2.3*2.2e-3, 2.5*2.2e-3]]"
            temp_estimation = "False"
            thermal_networks_type_g1 = "Foster"
            switch_Rth_g1 = "[0.159, 0.133, 0.120, 0.038]"
            switch_Tth_g1 = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            switch_Cth_g1 = "[0.0029, 0.0097, 0.1068, 0.8500]"
            diode_Rth_g1 = "[0.159, 0.133, 0.120, 0.038]"
            diode_Tth_g1 = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            diode_Cth_g1 = "[0.0029, 0.0097, 0.1068, 0.8500]"
            thermal_networks_type_g2 = "Foster"
            switch_Rth_g2 = "[0.159, 0.133, 0.120, 0.038]"
            switch_Tth_g2 = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            switch_Cth_g2 = "[0.0029, 0.0097, 0.1068, 0.8500]"
            diode_Rth_g2 = "[0.159, 0.133, 0.120, 0.038]"
            diode_Tth_g2 = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            diode_Cth_g2 = "[0.0029, 0.0097, 0.1068, 0.8500]"
            thermal_networks_type_g3 = "Foster"
            diode_Rth_g3 = "[0.159, 0.133, 0.120, 0.038]"
            diode_Tth_g3 = "[1.1e-1, 1.56e-2, 1.35e-3, 1.51e-4]"
            diode_Cth_g3 = "[0.0029, 0.0097, 0.1068, 0.8500]"
            loss_exec_rate = "100e-6"
            _control_property = "all high"
            pwm_enabling = "False"
            pwm_enable_di = "13"
            pwm_enable_inv = "active high"
            dtv_flag_en = "True"
            show_monitoring = "False"
            model_complexity = "Full"
        }

        "core/Three phase PLL" {
            initial_filter_output = "60"
            wn = "157.0796"
            zeta = "0.707"
            rate_high = "12"
            rate_low = "-12"
            freq_unit = "Hz"
            kp = "100"
            ki = "3200"
            kd = "1"
            N = "714.2857"
            initial_pid_output = "376.99111843"
            up_lim = "1e4"
            low_lim = "-1e4"
            kb = "1"
            power_form = "variant - Clarke\'s original"
            alignment = "-pi/2"
            disable_filter = "False"
            wn_LPFdq = "62.83185307"
            execution_rate = "inherit"
            enable_pk = "False"
            enable_zero = "True"
            enable_sin = "True"
        }

        "core/Three-phase UL 1741 voltage ride-through" {
            Vnom = "0"
        }

        "core/Triple Pole Single Throw Contactor" {
            ctrl_src = "Digital input"
            Sa = "1"
            Sa_logic = "active high"
            enable_fb_out = "False"
            fb_out_type = "real"
            execution_rate = "inherit"
            initial_state = "off"
            on_delay = "0"
            off_delay = "0"
        }

        "core/Voltage Measurement" {
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }
    }
}
